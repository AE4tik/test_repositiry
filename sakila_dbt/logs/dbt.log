[0m15:00:13.875923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C4DDF2AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C50B3AA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C50B3A7D0>]}


============================== 15:00:13.881901 | eb284c8a-ecde-4d05-9225-d1ba9eddc249 ==============================
[0m15:00:13.881901 [info ] [MainThread]: Running with dbt=1.6.0
[0m15:00:13.882897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\as4ti\\.dbt', 'log_path': 'C:\\Users\\as4ti\\OneDrive\\PowerBI\\Projects\\AgileEnginePBI\\Git_hub\\sakila_dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:00:14.000681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb284c8a-ecde-4d05-9225-d1ba9eddc249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C49E1CBE0>]}
[0m15:00:14.009636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb284c8a-ecde-4d05-9225-d1ba9eddc249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C50C6CCD0>]}
[0m15:00:14.011630 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m15:00:14.026580 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m15:00:14.027577 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:00:14.028574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'eb284c8a-ecde-4d05-9225-d1ba9eddc249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C50C6F910>]}
[0m15:00:15.380992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb284c8a-ecde-4d05-9225-d1ba9eddc249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C50E8A8C0>]}
[0m15:00:15.399116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb284c8a-ecde-4d05-9225-d1ba9eddc249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C50C6F5B0>]}
[0m15:00:15.399116 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m15:00:15.400158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb284c8a-ecde-4d05-9225-d1ba9eddc249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C50C6EC80>]}
[0m15:00:15.402107 [info ] [MainThread]: 
[0m15:00:15.404100 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:00:15.405095 [debug] [ThreadPool]: Acquiring new postgres connection 'list_marketing_public'
[0m15:00:15.415098 [debug] [ThreadPool]: Using postgres connection "list_marketing_public"
[0m15:00:15.415098 [debug] [ThreadPool]: On list_marketing_public: BEGIN
[0m15:00:15.416091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:16.618822 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m15:00:16.619823 [debug] [ThreadPool]: Using postgres connection "list_marketing_public"
[0m15:00:16.619823 [debug] [ThreadPool]: On list_marketing_public: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "list_marketing_public"} */
select
      'marketing' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'marketing' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'marketing' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:00:16.763719 [debug] [ThreadPool]: SQL status: SELECT 78 in 0.0 seconds
[0m15:00:16.769748 [debug] [ThreadPool]: On list_marketing_public: ROLLBACK
[0m15:00:16.894013 [debug] [ThreadPool]: On list_marketing_public: Close
[0m15:00:16.912707 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:16.912707 [debug] [MainThread]: On master: BEGIN
[0m15:00:16.913707 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:00:17.918342 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m15:00:17.919345 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:17.919345 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:00:18.066471 [debug] [MainThread]: SQL status: SELECT 32 in 0.0 seconds
[0m15:00:18.070053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb284c8a-ecde-4d05-9225-d1ba9eddc249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C50E89F00>]}
[0m15:00:18.071016 [debug] [MainThread]: On master: ROLLBACK
[0m15:00:18.194536 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:18.195596 [debug] [MainThread]: On master: BEGIN
[0m15:00:18.443842 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:00:18.444910 [debug] [MainThread]: On master: COMMIT
[0m15:00:18.446910 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:18.447908 [debug] [MainThread]: On master: COMMIT
[0m15:00:18.572342 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:00:18.572342 [debug] [MainThread]: On master: Close
[0m15:00:18.574340 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:00:18.576394 [info ] [MainThread]: 
[0m15:00:18.589401 [debug] [Thread-1 (]: Began running node test.sakila_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:00:18.590428 [info ] [Thread-1 (]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m15:00:18.592391 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.sakila_dbt.not_null_my_first_dbt_model_id.5fb22c2710'
[0m15:00:18.593388 [debug] [Thread-1 (]: Began compiling node test.sakila_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:00:18.613329 [debug] [Thread-1 (]: Writing injected SQL for node "test.sakila_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:00:18.615316 [debug] [Thread-1 (]: Timing info for test.sakila_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 15:00:18.594385 => 15:00:18.615316
[0m15:00:18.616311 [debug] [Thread-1 (]: Began executing node test.sakila_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:00:18.630683 [debug] [Thread-1 (]: Writing runtime sql for node "test.sakila_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:00:18.632680 [debug] [Thread-1 (]: Using postgres connection "test.sakila_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:00:18.633828 [debug] [Thread-1 (]: On test.sakila_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m15:00:18.633828 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:00:19.656894 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m15:00:19.657891 [debug] [Thread-1 (]: Using postgres connection "test.sakila_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:00:19.658888 [debug] [Thread-1 (]: On test.sakila_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "test.sakila_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "marketing"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m15:00:19.782976 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.my_first_dbt_model" does not exist
LINE 14: from "marketing"."public"."my_first_dbt_model"
              ^

[0m15:00:19.782976 [debug] [Thread-1 (]: On test.sakila_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m15:00:19.913589 [debug] [Thread-1 (]: Timing info for test.sakila_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 15:00:18.617356 => 15:00:19.912577
[0m15:00:19.913589 [debug] [Thread-1 (]: On test.sakila_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m15:00:20.004358 [debug] [Thread-1 (]: Database Error in test not_null_my_first_dbt_model_id (models\example\schema.yml)
  relation "public.my_first_dbt_model" does not exist
  LINE 14: from "marketing"."public"."my_first_dbt_model"
                ^
  compiled Code at target\run\sakila_dbt\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m15:00:20.005835 [error] [Thread-1 (]: 1 of 4 ERROR not_null_my_first_dbt_model_id .................................... [[31mERROR[0m in 1.41s]
[0m15:00:20.007222 [debug] [Thread-1 (]: Finished running node test.sakila_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:00:20.007222 [debug] [Thread-1 (]: Began running node test.sakila_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m15:00:20.008364 [info ] [Thread-1 (]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m15:00:20.010678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sakila_dbt.not_null_my_first_dbt_model_id.5fb22c2710, now test.sakila_dbt.not_null_my_second_dbt_model_id.151b76d778)
[0m15:00:20.010678 [debug] [Thread-1 (]: Began compiling node test.sakila_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m15:00:20.017840 [debug] [Thread-1 (]: Writing injected SQL for node "test.sakila_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m15:00:20.019226 [debug] [Thread-1 (]: Timing info for test.sakila_dbt.not_null_my_second_dbt_model_id.151b76d778 (compile): 15:00:20.010678 => 15:00:20.017840
[0m15:00:20.020222 [debug] [Thread-1 (]: Began executing node test.sakila_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m15:00:20.024209 [debug] [Thread-1 (]: Writing runtime sql for node "test.sakila_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m15:00:20.025206 [debug] [Thread-1 (]: Using postgres connection "test.sakila_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m15:00:20.026202 [debug] [Thread-1 (]: On test.sakila_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m15:00:20.027199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:21.043889 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m15:00:21.044885 [debug] [Thread-1 (]: Using postgres connection "test.sakila_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m15:00:21.045877 [debug] [Thread-1 (]: On test.sakila_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "test.sakila_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "marketing"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m15:00:21.179332 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.my_second_dbt_model" does not exist
LINE 14: from "marketing"."public"."my_second_dbt_model"
              ^

[0m15:00:21.180359 [debug] [Thread-1 (]: On test.sakila_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m15:00:21.307484 [debug] [Thread-1 (]: Timing info for test.sakila_dbt.not_null_my_second_dbt_model_id.151b76d778 (execute): 15:00:20.020222 => 15:00:21.306534
[0m15:00:21.308480 [debug] [Thread-1 (]: On test.sakila_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
[0m15:00:21.311569 [debug] [Thread-1 (]: Database Error in test not_null_my_second_dbt_model_id (models\example\schema.yml)
  relation "public.my_second_dbt_model" does not exist
  LINE 14: from "marketing"."public"."my_second_dbt_model"
                ^
  compiled Code at target\run\sakila_dbt\models\example\schema.yml\not_null_my_second_dbt_model_id.sql
[0m15:00:21.311569 [error] [Thread-1 (]: 2 of 4 ERROR not_null_my_second_dbt_model_id ................................... [[31mERROR[0m in 1.30s]
[0m15:00:21.313577 [debug] [Thread-1 (]: Finished running node test.sakila_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m15:00:21.313577 [debug] [Thread-1 (]: Began running node test.sakila_dbt.unique_my_first_dbt_model_id.16e066b321
[0m15:00:21.314929 [info ] [Thread-1 (]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m15:00:21.316963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sakila_dbt.not_null_my_second_dbt_model_id.151b76d778, now test.sakila_dbt.unique_my_first_dbt_model_id.16e066b321)
[0m15:00:21.316963 [debug] [Thread-1 (]: Began compiling node test.sakila_dbt.unique_my_first_dbt_model_id.16e066b321
[0m15:00:21.322953 [debug] [Thread-1 (]: Writing injected SQL for node "test.sakila_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m15:00:21.330890 [debug] [Thread-1 (]: Timing info for test.sakila_dbt.unique_my_first_dbt_model_id.16e066b321 (compile): 15:00:21.317922 => 15:00:21.330890
[0m15:00:21.331890 [debug] [Thread-1 (]: Began executing node test.sakila_dbt.unique_my_first_dbt_model_id.16e066b321
[0m15:00:21.336529 [debug] [Thread-1 (]: Writing runtime sql for node "test.sakila_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m15:00:21.338483 [debug] [Thread-1 (]: Using postgres connection "test.sakila_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m15:00:21.339480 [debug] [Thread-1 (]: On test.sakila_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m15:00:21.339480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:23.484044 [debug] [Thread-1 (]: SQL status: BEGIN in 2.0 seconds
[0m15:00:23.485084 [debug] [Thread-1 (]: Using postgres connection "test.sakila_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m15:00:23.486082 [debug] [Thread-1 (]: On test.sakila_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "test.sakila_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "marketing"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:00:23.611397 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.my_first_dbt_model" does not exist
LINE 15: from "marketing"."public"."my_first_dbt_model"
              ^

[0m15:00:23.612436 [debug] [Thread-1 (]: On test.sakila_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m15:00:23.737102 [debug] [Thread-1 (]: Timing info for test.sakila_dbt.unique_my_first_dbt_model_id.16e066b321 (execute): 15:00:21.332886 => 15:00:23.737102
[0m15:00:23.738137 [debug] [Thread-1 (]: On test.sakila_dbt.unique_my_first_dbt_model_id.16e066b321: Close
[0m15:00:23.740138 [debug] [Thread-1 (]: Database Error in test unique_my_first_dbt_model_id (models\example\schema.yml)
  relation "public.my_first_dbt_model" does not exist
  LINE 15: from "marketing"."public"."my_first_dbt_model"
                ^
  compiled Code at target\run\sakila_dbt\models\example\schema.yml\unique_my_first_dbt_model_id.sql
[0m15:00:23.740138 [error] [Thread-1 (]: 3 of 4 ERROR unique_my_first_dbt_model_id ...................................... [[31mERROR[0m in 2.42s]
[0m15:00:23.742092 [debug] [Thread-1 (]: Finished running node test.sakila_dbt.unique_my_first_dbt_model_id.16e066b321
[0m15:00:23.742092 [debug] [Thread-1 (]: Began running node test.sakila_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m15:00:23.743089 [info ] [Thread-1 (]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m15:00:23.745124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sakila_dbt.unique_my_first_dbt_model_id.16e066b321, now test.sakila_dbt.unique_my_second_dbt_model_id.57a0f8c493)
[0m15:00:23.745124 [debug] [Thread-1 (]: Began compiling node test.sakila_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m15:00:23.749119 [debug] [Thread-1 (]: Writing injected SQL for node "test.sakila_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m15:00:23.750076 [debug] [Thread-1 (]: Timing info for test.sakila_dbt.unique_my_second_dbt_model_id.57a0f8c493 (compile): 15:00:23.745124 => 15:00:23.750076
[0m15:00:23.750076 [debug] [Thread-1 (]: Began executing node test.sakila_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m15:00:23.753095 [debug] [Thread-1 (]: Writing runtime sql for node "test.sakila_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m15:00:23.754092 [debug] [Thread-1 (]: Using postgres connection "test.sakila_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m15:00:23.754092 [debug] [Thread-1 (]: On test.sakila_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m15:00:23.755049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:24.747501 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m15:00:24.747501 [debug] [Thread-1 (]: Using postgres connection "test.sakila_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m15:00:24.747501 [debug] [Thread-1 (]: On test.sakila_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "test.sakila_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "marketing"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:00:24.887611 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.my_second_dbt_model" does not exist
LINE 15: from "marketing"."public"."my_second_dbt_model"
              ^

[0m15:00:24.888609 [debug] [Thread-1 (]: On test.sakila_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m15:00:25.012486 [debug] [Thread-1 (]: Timing info for test.sakila_dbt.unique_my_second_dbt_model_id.57a0f8c493 (execute): 15:00:23.751106 => 15:00:25.012486
[0m15:00:25.013529 [debug] [Thread-1 (]: On test.sakila_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m15:00:25.014479 [debug] [Thread-1 (]: Database Error in test unique_my_second_dbt_model_id (models\example\schema.yml)
  relation "public.my_second_dbt_model" does not exist
  LINE 15: from "marketing"."public"."my_second_dbt_model"
                ^
  compiled Code at target\run\sakila_dbt\models\example\schema.yml\unique_my_second_dbt_model_id.sql
[0m15:00:25.015522 [error] [Thread-1 (]: 4 of 4 ERROR unique_my_second_dbt_model_id ..................................... [[31mERROR[0m in 1.27s]
[0m15:00:25.016472 [debug] [Thread-1 (]: Finished running node test.sakila_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m15:00:25.019463 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:25.019463 [debug] [MainThread]: On master: BEGIN
[0m15:00:25.020459 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:00:26.046758 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m15:00:26.047789 [debug] [MainThread]: On master: COMMIT
[0m15:00:26.047789 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:26.048800 [debug] [MainThread]: On master: COMMIT
[0m15:00:26.175600 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:00:26.175600 [debug] [MainThread]: On master: Close
[0m15:00:26.177597 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:00:26.177597 [debug] [MainThread]: Connection 'list_marketing_public' was properly closed.
[0m15:00:26.178593 [debug] [MainThread]: Connection 'test.sakila_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m15:00:26.179589 [info ] [MainThread]: 
[0m15:00:26.180627 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 10.78 seconds (10.78s).
[0m15:00:26.183625 [debug] [MainThread]: Command end result
[0m15:00:26.192550 [info ] [MainThread]: 
[0m15:00:26.193546 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m15:00:26.194550 [info ] [MainThread]: 
[0m15:00:26.195536 [error] [MainThread]: [33mDatabase Error in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m15:00:26.196535 [error] [MainThread]:   relation "public.my_first_dbt_model" does not exist
[0m15:00:26.197531 [error] [MainThread]:   LINE 14: from "marketing"."public"."my_first_dbt_model"
[0m15:00:26.198528 [error] [MainThread]:                 ^
[0m15:00:26.198528 [error] [MainThread]:   compiled Code at target\run\sakila_dbt\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m15:00:26.199523 [info ] [MainThread]: 
[0m15:00:26.200519 [error] [MainThread]: [33mDatabase Error in test not_null_my_second_dbt_model_id (models\example\schema.yml)[0m
[0m15:00:26.201700 [error] [MainThread]:   relation "public.my_second_dbt_model" does not exist
[0m15:00:26.201700 [error] [MainThread]:   LINE 14: from "marketing"."public"."my_second_dbt_model"
[0m15:00:26.202700 [error] [MainThread]:                 ^
[0m15:00:26.203704 [error] [MainThread]:   compiled Code at target\run\sakila_dbt\models\example\schema.yml\not_null_my_second_dbt_model_id.sql
[0m15:00:26.204694 [info ] [MainThread]: 
[0m15:00:26.204694 [error] [MainThread]: [33mDatabase Error in test unique_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m15:00:26.205689 [error] [MainThread]:   relation "public.my_first_dbt_model" does not exist
[0m15:00:26.206683 [error] [MainThread]:   LINE 15: from "marketing"."public"."my_first_dbt_model"
[0m15:00:26.207192 [error] [MainThread]:                 ^
[0m15:00:26.207192 [error] [MainThread]:   compiled Code at target\run\sakila_dbt\models\example\schema.yml\unique_my_first_dbt_model_id.sql
[0m15:00:26.208197 [info ] [MainThread]: 
[0m15:00:26.209194 [error] [MainThread]: [33mDatabase Error in test unique_my_second_dbt_model_id (models\example\schema.yml)[0m
[0m15:00:26.210193 [error] [MainThread]:   relation "public.my_second_dbt_model" does not exist
[0m15:00:26.210193 [error] [MainThread]:   LINE 15: from "marketing"."public"."my_second_dbt_model"
[0m15:00:26.211187 [error] [MainThread]:                 ^
[0m15:00:26.212184 [error] [MainThread]:   compiled Code at target\run\sakila_dbt\models\example\schema.yml\unique_my_second_dbt_model_id.sql
[0m15:00:26.212184 [info ] [MainThread]: 
[0m15:00:26.213181 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m15:00:26.215190 [debug] [MainThread]: Command `dbt test` failed at 15:00:26.214178 after 12.35 seconds
[0m15:00:26.215190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C4DDF2AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C50E06020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C50E11A50>]}
[0m15:00:26.216560 [debug] [MainThread]: Flushing usage events
[0m15:00:37.660082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B240512B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B24325A9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B24325A770>]}


============================== 15:00:37.663361 | dcb17b73-feb3-4739-bda8-c2dcec21ed76 ==============================
[0m15:00:37.663361 [info ] [MainThread]: Running with dbt=1.6.0
[0m15:00:37.664358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\as4ti\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\as4ti\\OneDrive\\PowerBI\\Projects\\AgileEnginePBI\\Git_hub\\sakila_dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:00:37.665354 [info ] [MainThread]: dbt version: 1.6.0
[0m15:00:37.666351 [info ] [MainThread]: python version: 3.10.10
[0m15:00:37.668345 [info ] [MainThread]: python path: C:\Python310\python.exe
[0m15:00:37.669342 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m15:00:37.726388 [info ] [MainThread]: Using profiles dir at C:\Users\as4ti\.dbt
[0m15:00:37.727469 [info ] [MainThread]: Using profiles.yml file at C:\Users\as4ti\.dbt\profiles.yml
[0m15:00:37.728470 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\as4ti\OneDrive\PowerBI\Projects\AgileEnginePBI\Git_hub\sakila_dbt\dbt_project.yml
[0m15:00:37.729466 [info ] [MainThread]: adapter type: postgres
[0m15:00:37.730463 [info ] [MainThread]: adapter version: 1.6.0
[0m15:00:37.743454 [info ] [MainThread]: Configuration:
[0m15:00:37.744418 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:00:37.745423 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:00:37.745423 [info ] [MainThread]: Required dependencies:
[0m15:00:37.746413 [debug] [MainThread]: Executing "git --help"
[0m15:00:37.763547 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:00:37.763547 [debug] [MainThread]: STDERR: "b''"
[0m15:00:37.764507 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:00:37.765548 [info ] [MainThread]: Connection:
[0m15:00:37.766411 [info ] [MainThread]:   host: dwh-analytics-marketing-replica.cm6kwlye3yy3.us-east-1.rds.amazonaws.com
[0m15:00:37.766915 [info ] [MainThread]:   port: 5432
[0m15:00:37.767913 [info ] [MainThread]:   user: illia_sterlihov
[0m15:00:37.768910 [info ] [MainThread]:   database: marketing
[0m15:00:37.768910 [info ] [MainThread]:   schema: public
[0m15:00:37.769913 [info ] [MainThread]:   connect_timeout: 5
[0m15:00:37.770913 [info ] [MainThread]:   role: None
[0m15:00:37.771915 [info ] [MainThread]:   search_path: None
[0m15:00:37.771915 [info ] [MainThread]:   keepalives_idle: 0
[0m15:00:37.772906 [info ] [MainThread]:   sslmode: None
[0m15:00:37.773912 [info ] [MainThread]:   sslcert: None
[0m15:00:37.774933 [info ] [MainThread]:   sslkey: None
[0m15:00:37.775897 [info ] [MainThread]:   sslrootcert: None
[0m15:00:37.775897 [info ] [MainThread]:   application_name: dbt
[0m15:00:37.776893 [info ] [MainThread]:   retries: 1
[0m15:00:37.777890 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m15:00:37.778886 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:00:37.779883 [debug] [MainThread]: Using postgres connection "debug"
[0m15:00:37.779883 [debug] [MainThread]: On debug: select 1 as id
[0m15:00:37.780879 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:00:38.891764 [debug] [MainThread]: SQL status: SELECT 1 in 1.0 seconds
[0m15:00:38.895749 [debug] [MainThread]: On debug: Close
[0m15:00:38.896746 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:00:38.898820 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:00:38.899820 [debug] [MainThread]: Command `dbt debug` succeeded at 15:00:38.899820 after 1.25 seconds
[0m15:00:38.900818 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:00:38.900818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B240512B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B243322860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2433674C0>]}
[0m15:00:38.901820 [debug] [MainThread]: Flushing usage events
[0m15:03:11.670568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E718E2B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E7462A980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E7462A740>]}


============================== 15:03:11.674157 | 273f5f23-f55a-430e-80bf-3021560f30b2 ==============================
[0m15:03:11.674157 [info ] [MainThread]: Running with dbt=1.6.0
[0m15:03:11.675181 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\as4ti\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\as4ti\\OneDrive\\PowerBI\\Projects\\AgileEnginePBI\\Git_hub\\sakila_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:03:11.676152 [info ] [MainThread]: dbt version: 1.6.0
[0m15:03:11.677147 [info ] [MainThread]: python version: 3.10.10
[0m15:03:11.677147 [info ] [MainThread]: python path: C:\Python310\python.exe
[0m15:03:11.678143 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m15:03:11.736515 [info ] [MainThread]: Using profiles dir at C:\Users\as4ti\.dbt
[0m15:03:11.737516 [info ] [MainThread]: Using profiles.yml file at C:\Users\as4ti\.dbt\profiles.yml
[0m15:03:11.738510 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\as4ti\OneDrive\PowerBI\Projects\AgileEnginePBI\Git_hub\sakila_dbt\dbt_project.yml
[0m15:03:11.740506 [info ] [MainThread]: adapter type: postgres
[0m15:03:11.741500 [info ] [MainThread]: adapter version: 1.6.0
[0m15:03:11.755453 [info ] [MainThread]: Configuration:
[0m15:03:11.756450 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:03:11.757833 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:03:11.757833 [info ] [MainThread]: Required dependencies:
[0m15:03:11.759173 [debug] [MainThread]: Executing "git --help"
[0m15:03:11.774973 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:03:11.775968 [debug] [MainThread]: STDERR: "b''"
[0m15:03:11.776964 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:03:11.776964 [info ] [MainThread]: Connection:
[0m15:03:11.778006 [info ] [MainThread]:   host: dwh-analytics-marketing-replica.cm6kwlye3yy3.us-east-1.rds.amazonaws.com
[0m15:03:11.778958 [info ] [MainThread]:   port: 5432
[0m15:03:11.778958 [info ] [MainThread]:   user: illia_sterlihov
[0m15:03:11.779972 [info ] [MainThread]:   database: marketing
[0m15:03:11.780998 [info ] [MainThread]:   schema: public
[0m15:03:11.780998 [info ] [MainThread]:   connect_timeout: 5
[0m15:03:11.781947 [info ] [MainThread]:   role: None
[0m15:03:11.781947 [info ] [MainThread]:   search_path: None
[0m15:03:11.782945 [info ] [MainThread]:   keepalives_idle: 0
[0m15:03:11.783986 [info ] [MainThread]:   sslmode: None
[0m15:03:11.783986 [info ] [MainThread]:   sslcert: None
[0m15:03:11.784963 [info ] [MainThread]:   sslkey: None
[0m15:03:11.784963 [info ] [MainThread]:   sslrootcert: None
[0m15:03:11.785984 [info ] [MainThread]:   application_name: dbt
[0m15:03:11.786937 [info ] [MainThread]:   retries: 1
[0m15:03:11.786937 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m15:03:11.787927 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:03:11.788927 [debug] [MainThread]: Using postgres connection "debug"
[0m15:03:11.788927 [debug] [MainThread]: On debug: select 1 as id
[0m15:03:11.788927 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:03:12.935383 [debug] [MainThread]: SQL status: SELECT 1 in 1.0 seconds
[0m15:03:12.937424 [debug] [MainThread]: On debug: Close
[0m15:03:12.937926 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:03:12.937926 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:03:12.937926 [debug] [MainThread]: Command `dbt debug` succeeded at 15:03:12.937926 after 1.28 seconds
[0m15:03:12.937926 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:03:12.937926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E718E2B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E71F71D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E74737E80>]}
[0m15:03:12.937926 [debug] [MainThread]: Flushing usage events
[0m15:28:15.960322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013823AB2B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000138267FE950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000138267FE710>]}


============================== 15:28:15.964274 | 6e2e0ac2-3866-4d56-8e9f-0e5835203694 ==============================
[0m15:28:15.964274 [info ] [MainThread]: Running with dbt=1.6.0
[0m15:28:15.965267 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\as4ti\\.dbt', 'log_path': 'C:\\Users\\as4ti\\OneDrive\\PowerBI\\Projects\\AgileEnginePBI\\Git_hub\\sakila_dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:28:15.965267 [info ] [MainThread]: dbt version: 1.6.0
[0m15:28:15.966267 [info ] [MainThread]: python version: 3.10.10
[0m15:28:15.967301 [info ] [MainThread]: python path: C:\Python310\python.exe
[0m15:28:15.968264 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m15:28:16.025887 [info ] [MainThread]: Using profiles dir at C:\Users\as4ti\.dbt
[0m15:28:16.026410 [info ] [MainThread]: Using profiles.yml file at C:\Users\as4ti\.dbt\profiles.yml
[0m15:28:16.027409 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\as4ti\OneDrive\PowerBI\Projects\AgileEnginePBI\Git_hub\sakila_dbt\dbt_project.yml
[0m15:28:16.028452 [info ] [MainThread]: adapter type: postgres
[0m15:28:16.029445 [info ] [MainThread]: adapter version: 1.6.0
[0m15:28:16.045620 [info ] [MainThread]: Configuration:
[0m15:28:16.046616 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:28:16.047663 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:28:16.048661 [info ] [MainThread]: Required dependencies:
[0m15:28:16.049660 [debug] [MainThread]: Executing "git --help"
[0m15:28:16.065935 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:28:16.066978 [debug] [MainThread]: STDERR: "b''"
[0m15:28:16.066978 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:28:16.068256 [info ] [MainThread]: Connection:
[0m15:28:16.069104 [info ] [MainThread]:   host: dwh-analytics-marketing-replica.cm6kwlye3yy3.us-east-1.rds.amazonaws.com
[0m15:28:16.069104 [info ] [MainThread]:   port: 5432
[0m15:28:16.070146 [info ] [MainThread]:   user: illia_sterlihov
[0m15:28:16.071137 [info ] [MainThread]:   database: marketing
[0m15:28:16.071137 [info ] [MainThread]:   schema: public
[0m15:28:16.072128 [info ] [MainThread]:   connect_timeout: 5
[0m15:28:16.073112 [info ] [MainThread]:   role: None
[0m15:28:16.074091 [info ] [MainThread]:   search_path: None
[0m15:28:16.074091 [info ] [MainThread]:   keepalives_idle: 0
[0m15:28:16.075122 [info ] [MainThread]:   sslmode: None
[0m15:28:16.076130 [info ] [MainThread]:   sslcert: None
[0m15:28:16.076130 [info ] [MainThread]:   sslkey: None
[0m15:28:16.077126 [info ] [MainThread]:   sslrootcert: None
[0m15:28:16.078078 [info ] [MainThread]:   application_name: dbt
[0m15:28:16.078078 [info ] [MainThread]:   retries: 1
[0m15:28:16.079073 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m15:28:16.080071 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:28:16.081111 [debug] [MainThread]: Using postgres connection "debug"
[0m15:28:16.081111 [debug] [MainThread]: On debug: select 1 as id
[0m15:28:16.082064 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:28:17.168696 [debug] [MainThread]: SQL status: SELECT 1 in 1.0 seconds
[0m15:28:17.170234 [debug] [MainThread]: On debug: Close
[0m15:28:17.172228 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:28:17.173229 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:28:17.174220 [debug] [MainThread]: Command `dbt debug` succeeded at 15:28:17.174220 after 1.23 seconds
[0m15:28:17.175254 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:28:17.175254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013823AB2B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000138268C39A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013826904130>]}
[0m15:28:17.176215 [debug] [MainThread]: Flushing usage events
[0m15:30:58.291434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017878832B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001787B57AB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001787B57A860>]}


============================== 15:30:58.295524 | e1d64c03-b019-4f5c-8938-a73533c9824e ==============================
[0m15:30:58.295524 [info ] [MainThread]: Running with dbt=1.6.0
[0m15:30:58.296530 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\as4ti\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\as4ti\\OneDrive\\PowerBI\\Projects\\AgileEnginePBI\\Git_hub\\sakila_dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:30:58.393429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1d64c03-b019-4f5c-8938-a73533c9824e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001787490CBE0>]}
[0m15:30:58.400789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1d64c03-b019-4f5c-8938-a73533c9824e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001787B6B0DC0>]}
[0m15:30:58.402841 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m15:30:58.410236 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m15:30:58.466034 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 4 files added, 1 files changed.
[0m15:30:58.466034 [debug] [MainThread]: Partial parsing: added file: sakila_dbt://models\example\zoho4tik_dbt_model1.sql
[0m15:30:58.467031 [debug] [MainThread]: Partial parsing: added file: sakila_dbt://models\test_dbt1\schema.yml
[0m15:30:58.468028 [debug] [MainThread]: Partial parsing: added file: sakila_dbt://models\example\zoho4tik_dbt_model2.sql
[0m15:30:58.469022 [debug] [MainThread]: Partial parsing: added file: sakila_dbt://models\test_dbt1\freezed_cand1.sql
[0m15:30:58.469022 [debug] [MainThread]: Partial parsing: updated file: sakila_dbt://models\example\schema.yml
[0m15:30:58.470019 [debug] [MainThread]: Partial parsing: deleted file: sakila_dbt://models\example\my_second_dbt_model.sql
[0m15:30:58.470019 [debug] [MainThread]: Partial parsing: deleted file: sakila_dbt://models\example\my_first_dbt_model.sql
[0m15:30:58.539915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1d64c03-b019-4f5c-8938-a73533c9824e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001787B9240D0>]}
[0m15:30:58.550009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1d64c03-b019-4f5c-8938-a73533c9824e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001787B8E2CE0>]}
[0m15:30:58.551005 [info ] [MainThread]: Found 3 models, 6 tests, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m15:30:58.552002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1d64c03-b019-4f5c-8938-a73533c9824e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001787B86CC70>]}
[0m15:30:58.552998 [info ] [MainThread]: 
[0m15:30:58.553995 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:30:58.555988 [debug] [ThreadPool]: Acquiring new postgres connection 'list_marketing'
[0m15:30:58.567458 [debug] [ThreadPool]: Using postgres connection "list_marketing"
[0m15:30:58.568453 [debug] [ThreadPool]: On list_marketing: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "list_marketing"} */

    select distinct nspname from pg_namespace
  
[0m15:30:58.569450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:59.634597 [debug] [ThreadPool]: SQL status: SELECT 9 in 1.0 seconds
[0m15:30:59.638583 [debug] [ThreadPool]: On list_marketing: Close
[0m15:30:59.642569 [debug] [ThreadPool]: Acquiring new postgres connection 'list_marketing_public'
[0m15:30:59.651689 [debug] [ThreadPool]: Using postgres connection "list_marketing_public"
[0m15:30:59.651689 [debug] [ThreadPool]: On list_marketing_public: BEGIN
[0m15:30:59.652674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:00.673915 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m15:31:00.674952 [debug] [ThreadPool]: Using postgres connection "list_marketing_public"
[0m15:31:00.674952 [debug] [ThreadPool]: On list_marketing_public: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "list_marketing_public"} */
select
      'marketing' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'marketing' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'marketing' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:31:00.813901 [debug] [ThreadPool]: SQL status: SELECT 79 in 0.0 seconds
[0m15:31:00.816893 [debug] [ThreadPool]: On list_marketing_public: ROLLBACK
[0m15:31:00.943131 [debug] [ThreadPool]: On list_marketing_public: Close
[0m15:31:00.962511 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:00.963508 [debug] [MainThread]: On master: BEGIN
[0m15:31:00.964504 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:31:02.072439 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m15:31:02.073442 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:02.074431 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:31:02.215816 [debug] [MainThread]: SQL status: SELECT 32 in 0.0 seconds
[0m15:31:02.218785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1d64c03-b019-4f5c-8938-a73533c9824e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001787B6B25F0>]}
[0m15:31:02.219824 [debug] [MainThread]: On master: ROLLBACK
[0m15:31:02.345598 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:02.346594 [debug] [MainThread]: On master: BEGIN
[0m15:31:02.599150 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:31:02.600206 [debug] [MainThread]: On master: COMMIT
[0m15:31:02.602183 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:02.603146 [debug] [MainThread]: On master: COMMIT
[0m15:31:02.729697 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:31:02.730699 [debug] [MainThread]: On master: Close
[0m15:31:02.731701 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:31:02.733682 [info ] [MainThread]: 
[0m15:31:02.737740 [debug] [Thread-1 (]: Began running node model.sakila_dbt.freezed_cand1
[0m15:31:02.738741 [info ] [Thread-1 (]: 1 of 3 START sql view model public.freezed_cand1 ............................... [RUN]
[0m15:31:02.739789 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sakila_dbt.freezed_cand1'
[0m15:31:02.740766 [debug] [Thread-1 (]: Began compiling node model.sakila_dbt.freezed_cand1
[0m15:31:02.749703 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakila_dbt.freezed_cand1"
[0m15:31:02.751654 [debug] [Thread-1 (]: Timing info for model.sakila_dbt.freezed_cand1 (compile): 15:31:02.741770 => 15:31:02.751654
[0m15:31:02.752738 [debug] [Thread-1 (]: Began executing node model.sakila_dbt.freezed_cand1
[0m15:31:02.787894 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakila_dbt.freezed_cand1"
[0m15:31:02.788898 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m15:31:02.789844 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: BEGIN
[0m15:31:02.790842 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:31:03.818009 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m15:31:03.819002 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m15:31:03.819002 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */

  create view "marketing"."public"."freezed_cand1__dbt_tmp"
    
    
  as (
    -- 

select *
from public.freezed_candidate_data a
limit 10
  );
[0m15:31:03.963120 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:31:03.969147 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m15:31:03.969147 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */
alter table "marketing"."public"."freezed_cand1__dbt_tmp" rename to "freezed_cand1"
[0m15:31:04.088567 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:31:04.110378 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: COMMIT
[0m15:31:04.110378 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m15:31:04.111337 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: COMMIT
[0m15:31:04.238888 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:31:04.250974 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m15:31:04.251935 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */
drop view if exists "marketing"."public"."freezed_cand1__dbt_backup" cascade
[0m15:31:04.384934 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:31:04.385317 [debug] [Thread-1 (]: Timing info for model.sakila_dbt.freezed_cand1 (execute): 15:31:02.752738 => 15:31:04.385317
[0m15:31:04.385317 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: Close
[0m15:31:04.390773 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1d64c03-b019-4f5c-8938-a73533c9824e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001787B8109D0>]}
[0m15:31:04.390773 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.freezed_cand1 .......................... [[32mCREATE VIEW[0m in 1.65s]
[0m15:31:04.390773 [debug] [Thread-1 (]: Finished running node model.sakila_dbt.freezed_cand1
[0m15:31:04.390773 [debug] [Thread-1 (]: Began running node model.sakila_dbt.zoho4tik_dbt_model1
[0m15:31:04.395232 [info ] [Thread-1 (]: 2 of 3 START sql table model public.zoho4tik_dbt_model1 ........................ [RUN]
[0m15:31:04.397113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakila_dbt.freezed_cand1, now model.sakila_dbt.zoho4tik_dbt_model1)
[0m15:31:04.398832 [debug] [Thread-1 (]: Began compiling node model.sakila_dbt.zoho4tik_dbt_model1
[0m15:31:04.402638 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakila_dbt.zoho4tik_dbt_model1"
[0m15:31:04.404631 [debug] [Thread-1 (]: Timing info for model.sakila_dbt.zoho4tik_dbt_model1 (compile): 15:31:04.398832 => 15:31:04.404631
[0m15:31:04.405628 [debug] [Thread-1 (]: Began executing node model.sakila_dbt.zoho4tik_dbt_model1
[0m15:31:04.429549 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakila_dbt.zoho4tik_dbt_model1"
[0m15:31:04.431682 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model1"
[0m15:31:04.432679 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model1: BEGIN
[0m15:31:04.433676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:05.598715 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m15:31:05.599734 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model1"
[0m15:31:05.601666 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.zoho4tik_dbt_model1"} */

  
    

  create  table "marketing"."public"."zoho4tik_dbt_model1__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:31:05.737188 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m15:31:05.744039 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model1"
[0m15:31:05.745036 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.zoho4tik_dbt_model1"} */
alter table "marketing"."public"."zoho4tik_dbt_model1__dbt_tmp" rename to "zoho4tik_dbt_model1"
[0m15:31:05.872758 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:31:05.878752 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model1: COMMIT
[0m15:31:05.879747 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model1"
[0m15:31:05.880745 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model1: COMMIT
[0m15:31:06.006927 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:31:06.006927 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model1"
[0m15:31:06.006927 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.zoho4tik_dbt_model1"} */
drop table if exists "marketing"."public"."zoho4tik_dbt_model1__dbt_backup" cascade
[0m15:31:06.146041 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:31:06.150076 [debug] [Thread-1 (]: Timing info for model.sakila_dbt.zoho4tik_dbt_model1 (execute): 15:31:04.405628 => 15:31:06.150076
[0m15:31:06.152034 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model1: Close
[0m15:31:06.154022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1d64c03-b019-4f5c-8938-a73533c9824e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001787BA23BB0>]}
[0m15:31:06.155052 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.zoho4tik_dbt_model1 ................... [[32mSELECT 2[0m in 1.76s]
[0m15:31:06.156015 [debug] [Thread-1 (]: Finished running node model.sakila_dbt.zoho4tik_dbt_model1
[0m15:31:06.158004 [debug] [Thread-1 (]: Began running node model.sakila_dbt.zoho4tik_dbt_model2
[0m15:31:06.160049 [info ] [Thread-1 (]: 3 of 3 START sql view model public.zoho4tik_dbt_model2 ......................... [RUN]
[0m15:31:06.161995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakila_dbt.zoho4tik_dbt_model1, now model.sakila_dbt.zoho4tik_dbt_model2)
[0m15:31:06.162989 [debug] [Thread-1 (]: Began compiling node model.sakila_dbt.zoho4tik_dbt_model2
[0m15:31:06.207840 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakila_dbt.zoho4tik_dbt_model2"
[0m15:31:06.208836 [debug] [Thread-1 (]: Timing info for model.sakila_dbt.zoho4tik_dbt_model2 (compile): 15:31:06.163989 => 15:31:06.208836
[0m15:31:06.209831 [debug] [Thread-1 (]: Began executing node model.sakila_dbt.zoho4tik_dbt_model2
[0m15:31:06.215843 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakila_dbt.zoho4tik_dbt_model2"
[0m15:31:06.216847 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model2"
[0m15:31:06.217804 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model2: BEGIN
[0m15:31:06.217804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:07.236252 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m15:31:07.237248 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model2"
[0m15:31:07.237248 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model2: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.zoho4tik_dbt_model2"} */

  create view "marketing"."public"."zoho4tik_dbt_model2__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "marketing"."public"."zoho4tik_dbt_model1"
where id = 1
  );
[0m15:31:07.366905 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:31:07.372883 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model2"
[0m15:31:07.373880 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model2: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.zoho4tik_dbt_model2"} */
alter table "marketing"."public"."zoho4tik_dbt_model2__dbt_tmp" rename to "zoho4tik_dbt_model2"
[0m15:31:07.497343 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:31:07.500822 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model2: COMMIT
[0m15:31:07.500822 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model2"
[0m15:31:07.501818 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model2: COMMIT
[0m15:31:07.626444 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:31:07.629435 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model2"
[0m15:31:07.630435 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model2: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.zoho4tik_dbt_model2"} */
drop view if exists "marketing"."public"."zoho4tik_dbt_model2__dbt_backup" cascade
[0m15:31:07.755097 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:31:07.756095 [debug] [Thread-1 (]: Timing info for model.sakila_dbt.zoho4tik_dbt_model2 (execute): 15:31:06.210827 => 15:31:07.756095
[0m15:31:07.757093 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model2: Close
[0m15:31:07.759081 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1d64c03-b019-4f5c-8938-a73533c9824e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001787B889660>]}
[0m15:31:07.759081 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.zoho4tik_dbt_model2 .................... [[32mCREATE VIEW[0m in 1.60s]
[0m15:31:07.761075 [debug] [Thread-1 (]: Finished running node model.sakila_dbt.zoho4tik_dbt_model2
[0m15:31:07.763215 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:07.764262 [debug] [MainThread]: On master: BEGIN
[0m15:31:07.765208 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:31:08.802445 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m15:31:08.803384 [debug] [MainThread]: On master: COMMIT
[0m15:31:08.805376 [debug] [MainThread]: Using postgres connection "master"
[0m15:31:08.806372 [debug] [MainThread]: On master: COMMIT
[0m15:31:08.933234 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:31:08.934198 [debug] [MainThread]: On master: Close
[0m15:31:08.935238 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:31:08.936829 [debug] [MainThread]: Connection 'list_marketing' was properly closed.
[0m15:31:08.936829 [debug] [MainThread]: Connection 'list_marketing_public' was properly closed.
[0m15:31:08.937831 [debug] [MainThread]: Connection 'model.sakila_dbt.zoho4tik_dbt_model2' was properly closed.
[0m15:31:08.937831 [info ] [MainThread]: 
[0m15:31:08.939753 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 10.38 seconds (10.38s).
[0m15:31:08.940757 [debug] [MainThread]: Command end result
[0m15:31:08.948730 [info ] [MainThread]: 
[0m15:31:08.949733 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:31:08.950926 [info ] [MainThread]: 
[0m15:31:08.951929 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:31:08.951929 [debug] [MainThread]: Command `dbt run` succeeded at 15:31:08.951929 after 10.67 seconds
[0m15:31:08.952968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017878832B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001787B86C430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001787BA207C0>]}
[0m15:31:08.952968 [debug] [MainThread]: Flushing usage events
[0m15:49:11.462405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157B40A2B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157B6DFAB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157B6DFA8C0>]}


============================== 15:49:11.466487 | e7512ddd-3788-4fd2-ba3a-b9f807f9980e ==============================
[0m15:49:11.466487 [info ] [MainThread]: Running with dbt=1.6.0
[0m15:49:11.468481 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\as4ti\\.dbt', 'log_path': 'C:\\Users\\as4ti\\OneDrive\\PowerBI\\Projects\\AgileEnginePBI\\Git_hub\\sakila_dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:49:11.566235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7512ddd-3788-4fd2-ba3a-b9f807f9980e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157B009CBE0>]}
[0m15:49:11.573210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7512ddd-3788-4fd2-ba3a-b9f807f9980e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157B6F34D90>]}
[0m15:49:11.575249 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m15:49:11.583178 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m15:49:11.591187 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:49:11.591706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e7512ddd-3788-4fd2-ba3a-b9f807f9980e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157B6F37490>]}
[0m15:49:12.247745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7512ddd-3788-4fd2-ba3a-b9f807f9980e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157B6FA3AC0>]}
[0m15:49:12.259139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7512ddd-3788-4fd2-ba3a-b9f807f9980e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157B6EBACE0>]}
[0m15:49:12.260136 [info ] [MainThread]: Found 3 models, 6 tests, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m15:49:12.261134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7512ddd-3788-4fd2-ba3a-b9f807f9980e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157B6FA1C30>]}
[0m15:49:12.263167 [info ] [MainThread]: 
[0m15:49:12.265156 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:49:12.266117 [debug] [ThreadPool]: Acquiring new postgres connection 'list_marketing'
[0m15:49:12.275124 [debug] [ThreadPool]: Using postgres connection "list_marketing"
[0m15:49:12.276083 [debug] [ThreadPool]: On list_marketing: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "list_marketing"} */

    select distinct nspname from pg_namespace
  
[0m15:49:12.277080 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:13.414063 [debug] [ThreadPool]: SQL status: SELECT 9 in 1.0 seconds
[0m15:49:13.417102 [debug] [ThreadPool]: On list_marketing: Close
[0m15:49:13.421162 [debug] [ThreadPool]: Acquiring new postgres connection 'list_marketing_public'
[0m15:49:13.428138 [debug] [ThreadPool]: Using postgres connection "list_marketing_public"
[0m15:49:13.429135 [debug] [ThreadPool]: On list_marketing_public: BEGIN
[0m15:49:13.430133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:14.432990 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m15:49:14.433981 [debug] [ThreadPool]: Using postgres connection "list_marketing_public"
[0m15:49:14.433981 [debug] [ThreadPool]: On list_marketing_public: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "list_marketing_public"} */
select
      'marketing' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'marketing' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'marketing' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:49:14.563153 [debug] [ThreadPool]: SQL status: SELECT 78 in 0.0 seconds
[0m15:49:14.565636 [debug] [ThreadPool]: On list_marketing_public: ROLLBACK
[0m15:49:14.689051 [debug] [ThreadPool]: On list_marketing_public: Close
[0m15:49:14.704011 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:14.705003 [debug] [MainThread]: On master: BEGIN
[0m15:49:14.705003 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:49:15.848618 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m15:49:15.849666 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:15.851666 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:49:16.002115 [debug] [MainThread]: SQL status: SELECT 31 in 0.0 seconds
[0m15:49:16.005071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7512ddd-3788-4fd2-ba3a-b9f807f9980e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157B704F730>]}
[0m15:49:16.006031 [debug] [MainThread]: On master: ROLLBACK
[0m15:49:16.129669 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:16.131738 [debug] [MainThread]: On master: BEGIN
[0m15:49:16.381124 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:49:16.382119 [debug] [MainThread]: On master: COMMIT
[0m15:49:16.383115 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:16.384659 [debug] [MainThread]: On master: COMMIT
[0m15:49:16.509382 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:49:16.510383 [debug] [MainThread]: On master: Close
[0m15:49:16.511397 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:49:16.512376 [info ] [MainThread]: 
[0m15:49:16.517015 [debug] [Thread-1 (]: Began running node model.sakila_dbt.freezed_cand1
[0m15:49:16.517015 [info ] [Thread-1 (]: 1 of 3 START sql view model public.freezed_cand1 ............................... [RUN]
[0m15:49:16.519015 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sakila_dbt.freezed_cand1'
[0m15:49:16.520009 [debug] [Thread-1 (]: Began compiling node model.sakila_dbt.freezed_cand1
[0m15:49:16.528977 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakila_dbt.freezed_cand1"
[0m15:49:16.530972 [debug] [Thread-1 (]: Timing info for model.sakila_dbt.freezed_cand1 (compile): 15:49:16.520009 => 15:49:16.530010
[0m15:49:16.530972 [debug] [Thread-1 (]: Began executing node model.sakila_dbt.freezed_cand1
[0m15:49:16.572616 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakila_dbt.freezed_cand1"
[0m15:49:16.573987 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m15:49:16.575431 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: BEGIN
[0m15:49:16.575431 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:49:17.584622 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m15:49:17.586664 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m15:49:17.587660 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */

  create view "marketing"."public"."freezed_cand1__dbt_tmp"
    
    
  as (
    -- 

select *
from public.freezed_candidate_data a
limit 10
  );
[0m15:49:17.724766 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:49:17.734771 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m15:49:17.735779 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */
alter table "marketing"."public"."freezed_cand1" rename to "freezed_cand1__dbt_backup"
[0m15:49:17.861095 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:49:17.866098 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m15:49:17.866098 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */
alter table "marketing"."public"."freezed_cand1__dbt_tmp" rename to "freezed_cand1"
[0m15:49:17.991626 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:49:18.009619 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: COMMIT
[0m15:49:18.010609 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m15:49:18.011563 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: COMMIT
[0m15:49:18.136527 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:49:18.143547 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m15:49:18.144539 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */
drop view if exists "marketing"."public"."freezed_cand1__dbt_backup" cascade
[0m15:49:18.270410 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:49:18.274387 [debug] [Thread-1 (]: Timing info for model.sakila_dbt.freezed_cand1 (execute): 15:49:16.531983 => 15:49:18.274387
[0m15:49:18.275399 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: Close
[0m15:49:18.277332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7512ddd-3788-4fd2-ba3a-b9f807f9980e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157B6EE0B80>]}
[0m15:49:18.278328 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.freezed_cand1 .......................... [[32mCREATE VIEW[0m in 1.76s]
[0m15:49:18.280369 [debug] [Thread-1 (]: Finished running node model.sakila_dbt.freezed_cand1
[0m15:49:18.281318 [debug] [Thread-1 (]: Began running node model.sakila_dbt.zoho4tik_dbt_model1
[0m15:49:18.283341 [info ] [Thread-1 (]: 2 of 3 START sql table model public.zoho4tik_dbt_model1 ........................ [RUN]
[0m15:49:18.284338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakila_dbt.freezed_cand1, now model.sakila_dbt.zoho4tik_dbt_model1)
[0m15:49:18.285335 [debug] [Thread-1 (]: Began compiling node model.sakila_dbt.zoho4tik_dbt_model1
[0m15:49:18.288599 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakila_dbt.zoho4tik_dbt_model1"
[0m15:49:18.290592 [debug] [Thread-1 (]: Timing info for model.sakila_dbt.zoho4tik_dbt_model1 (compile): 15:49:18.286603 => 15:49:18.290592
[0m15:49:18.291589 [debug] [Thread-1 (]: Began executing node model.sakila_dbt.zoho4tik_dbt_model1
[0m15:49:18.319902 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakila_dbt.zoho4tik_dbt_model1"
[0m15:49:18.321894 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model1"
[0m15:49:18.321894 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model1: BEGIN
[0m15:49:18.322925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:19.413512 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m15:49:19.415465 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model1"
[0m15:49:19.416541 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.zoho4tik_dbt_model1"} */

  
    

  create  table "marketing"."public"."zoho4tik_dbt_model1__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:49:19.549030 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m15:49:19.556061 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model1"
[0m15:49:19.557055 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.zoho4tik_dbt_model1"} */
alter table "marketing"."public"."zoho4tik_dbt_model1__dbt_tmp" rename to "zoho4tik_dbt_model1"
[0m15:49:19.684578 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:49:19.688564 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model1: COMMIT
[0m15:49:19.689561 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model1"
[0m15:49:19.690558 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model1: COMMIT
[0m15:49:19.818281 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:49:19.828727 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model1"
[0m15:49:19.829714 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.zoho4tik_dbt_model1"} */
drop table if exists "marketing"."public"."zoho4tik_dbt_model1__dbt_backup" cascade
[0m15:49:19.957081 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:49:19.959119 [debug] [Thread-1 (]: Timing info for model.sakila_dbt.zoho4tik_dbt_model1 (execute): 15:49:18.291589 => 15:49:19.959119
[0m15:49:19.959119 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model1: Close
[0m15:49:19.960120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7512ddd-3788-4fd2-ba3a-b9f807f9980e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157B71C6080>]}
[0m15:49:19.961112 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.zoho4tik_dbt_model1 ................... [[32mSELECT 2[0m in 1.68s]
[0m15:49:19.963071 [debug] [Thread-1 (]: Finished running node model.sakila_dbt.zoho4tik_dbt_model1
[0m15:49:19.965059 [debug] [Thread-1 (]: Began running node model.sakila_dbt.zoho4tik_dbt_model2
[0m15:49:19.966058 [info ] [Thread-1 (]: 3 of 3 START sql view model public.zoho4tik_dbt_model2 ......................... [RUN]
[0m15:49:19.967093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakila_dbt.zoho4tik_dbt_model1, now model.sakila_dbt.zoho4tik_dbt_model2)
[0m15:49:19.968081 [debug] [Thread-1 (]: Began compiling node model.sakila_dbt.zoho4tik_dbt_model2
[0m15:49:19.971039 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakila_dbt.zoho4tik_dbt_model2"
[0m15:49:19.972079 [debug] [Thread-1 (]: Timing info for model.sakila_dbt.zoho4tik_dbt_model2 (compile): 15:49:19.969091 => 15:49:19.972079
[0m15:49:19.973036 [debug] [Thread-1 (]: Began executing node model.sakila_dbt.zoho4tik_dbt_model2
[0m15:49:19.978144 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakila_dbt.zoho4tik_dbt_model2"
[0m15:49:19.979141 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model2"
[0m15:49:19.979141 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model2: BEGIN
[0m15:49:19.980138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:21.010173 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m15:49:21.011210 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model2"
[0m15:49:21.012206 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model2: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.zoho4tik_dbt_model2"} */

  create view "marketing"."public"."zoho4tik_dbt_model2__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "marketing"."public"."zoho4tik_dbt_model1"
where id = 1
  );
[0m15:49:21.143203 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:49:21.148193 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model2"
[0m15:49:21.149147 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model2: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.zoho4tik_dbt_model2"} */
alter table "marketing"."public"."zoho4tik_dbt_model2__dbt_tmp" rename to "zoho4tik_dbt_model2"
[0m15:49:21.275898 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:49:21.280865 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model2: COMMIT
[0m15:49:21.281865 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model2"
[0m15:49:21.283877 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model2: COMMIT
[0m15:49:21.411775 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:49:21.414787 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model2"
[0m15:49:21.414787 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model2: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.zoho4tik_dbt_model2"} */
drop view if exists "marketing"."public"."zoho4tik_dbt_model2__dbt_backup" cascade
[0m15:49:21.542138 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:49:21.545978 [debug] [Thread-1 (]: Timing info for model.sakila_dbt.zoho4tik_dbt_model2 (execute): 15:49:19.973036 => 15:49:21.545978
[0m15:49:21.547023 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model2: Close
[0m15:49:21.549002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7512ddd-3788-4fd2-ba3a-b9f807f9980e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157B71C5900>]}
[0m15:49:21.549968 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.zoho4tik_dbt_model2 .................... [[32mCREATE VIEW[0m in 1.58s]
[0m15:49:21.551010 [debug] [Thread-1 (]: Finished running node model.sakila_dbt.zoho4tik_dbt_model2
[0m15:49:21.553950 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:21.554947 [debug] [MainThread]: On master: BEGIN
[0m15:49:21.554947 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:49:22.584573 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m15:49:22.585615 [debug] [MainThread]: On master: COMMIT
[0m15:49:22.586612 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:22.587608 [debug] [MainThread]: On master: COMMIT
[0m15:49:22.715123 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:49:22.715123 [debug] [MainThread]: On master: Close
[0m15:49:22.716124 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:49:22.717824 [debug] [MainThread]: Connection 'list_marketing' was properly closed.
[0m15:49:22.718826 [debug] [MainThread]: Connection 'list_marketing_public' was properly closed.
[0m15:49:22.718826 [debug] [MainThread]: Connection 'model.sakila_dbt.zoho4tik_dbt_model2' was properly closed.
[0m15:49:22.719822 [info ] [MainThread]: 
[0m15:49:22.720819 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 10.46 seconds (10.46s).
[0m15:49:22.722914 [debug] [MainThread]: Command end result
[0m15:49:22.730887 [info ] [MainThread]: 
[0m15:49:22.731884 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:49:22.732920 [info ] [MainThread]: 
[0m15:49:22.733889 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:49:22.734875 [debug] [MainThread]: Command `dbt run` succeeded at 15:49:22.734875 after 11.28 seconds
[0m15:49:22.735872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157B40A2B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157B6FA05E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000157B70928F0>]}
[0m15:49:22.735872 [debug] [MainThread]: Flushing usage events
[0m15:50:32.995394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A787DA2B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A78AAEAB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A78AAEA8C0>]}


============================== 15:50:32.999050 | 1341fe1a-eec1-4984-8a93-60a813b91064 ==============================
[0m15:50:32.999050 [info ] [MainThread]: Running with dbt=1.6.0
[0m15:50:33.000054 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\as4ti\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\as4ti\\OneDrive\\PowerBI\\Projects\\AgileEnginePBI\\Git_hub\\sakila_dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:50:33.092546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1341fe1a-eec1-4984-8a93-60a813b91064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A783E2CBE0>]}
[0m15:50:33.100518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1341fe1a-eec1-4984-8a93-60a813b91064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A78AC28F10>]}
[0m15:50:33.101516 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m15:50:33.109487 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m15:50:33.147871 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:50:33.148869 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:50:33.153857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1341fe1a-eec1-4984-8a93-60a813b91064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A78ADACF10>]}
[0m15:50:33.165381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1341fe1a-eec1-4984-8a93-60a813b91064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A78AC79000>]}
[0m15:50:33.166383 [info ] [MainThread]: Found 3 models, 6 tests, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m15:50:33.167379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1341fe1a-eec1-4984-8a93-60a813b91064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A78AC78EB0>]}
[0m15:50:33.169778 [info ] [MainThread]: 
[0m15:50:33.170904 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:50:33.173013 [debug] [ThreadPool]: Acquiring new postgres connection 'list_marketing'
[0m15:50:33.185138 [debug] [ThreadPool]: Using postgres connection "list_marketing"
[0m15:50:33.186135 [debug] [ThreadPool]: On list_marketing: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "list_marketing"} */

    select distinct nspname from pg_namespace
  
[0m15:50:33.187131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:34.320137 [debug] [ThreadPool]: SQL status: SELECT 9 in 1.0 seconds
[0m15:50:34.323203 [debug] [ThreadPool]: On list_marketing: Close
[0m15:50:34.327151 [debug] [ThreadPool]: Acquiring new postgres connection 'list_marketing_public'
[0m15:50:34.336471 [debug] [ThreadPool]: Using postgres connection "list_marketing_public"
[0m15:50:34.336471 [debug] [ThreadPool]: On list_marketing_public: BEGIN
[0m15:50:34.336471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:35.361051 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m15:50:35.363001 [debug] [ThreadPool]: Using postgres connection "list_marketing_public"
[0m15:50:35.363001 [debug] [ThreadPool]: On list_marketing_public: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "list_marketing_public"} */
select
      'marketing' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'marketing' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'marketing' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:50:35.489952 [debug] [ThreadPool]: SQL status: SELECT 80 in 0.0 seconds
[0m15:50:35.489952 [debug] [ThreadPool]: On list_marketing_public: ROLLBACK
[0m15:50:35.622779 [debug] [ThreadPool]: On list_marketing_public: Close
[0m15:50:35.641680 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:35.642691 [debug] [MainThread]: On master: BEGIN
[0m15:50:35.642691 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:50:36.674955 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m15:50:36.675952 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:36.676948 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:50:36.816207 [debug] [MainThread]: SQL status: SELECT 32 in 0.0 seconds
[0m15:50:36.819242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1341fe1a-eec1-4984-8a93-60a813b91064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A78AE0AF50>]}
[0m15:50:36.820245 [debug] [MainThread]: On master: ROLLBACK
[0m15:50:36.948452 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:36.949457 [debug] [MainThread]: On master: BEGIN
[0m15:50:37.203509 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:50:37.204986 [debug] [MainThread]: On master: COMMIT
[0m15:50:37.206987 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:37.207983 [debug] [MainThread]: On master: COMMIT
[0m15:50:37.335463 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:50:37.336466 [debug] [MainThread]: On master: Close
[0m15:50:37.337461 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:50:37.338458 [info ] [MainThread]: 
[0m15:50:37.343470 [debug] [Thread-1 (]: Began running node model.sakila_dbt.freezed_cand1
[0m15:50:37.344441 [info ] [Thread-1 (]: 1 of 3 START sql view model public.freezed_cand1 ............................... [RUN]
[0m15:50:37.346431 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sakila_dbt.freezed_cand1'
[0m15:50:37.347427 [debug] [Thread-1 (]: Began compiling node model.sakila_dbt.freezed_cand1
[0m15:50:37.350235 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakila_dbt.freezed_cand1"
[0m15:50:37.350235 [debug] [Thread-1 (]: Timing info for model.sakila_dbt.freezed_cand1 (compile): 15:50:37.348622 => 15:50:37.350235
[0m15:50:37.350235 [debug] [Thread-1 (]: Began executing node model.sakila_dbt.freezed_cand1
[0m15:50:37.402829 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakila_dbt.freezed_cand1"
[0m15:50:37.403862 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m15:50:37.403862 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: BEGIN
[0m15:50:37.404949 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:50:38.427467 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m15:50:38.429509 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m15:50:38.430505 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */

  create view "marketing"."public"."freezed_cand1__dbt_tmp"
    
    
  as (
    -- 

select *
from public.freezed_candidate_data a
limit 10
  );
[0m15:50:38.562772 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:50:38.573679 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m15:50:38.574675 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */
alter table "marketing"."public"."freezed_cand1" rename to "freezed_cand1__dbt_backup"
[0m15:50:38.702063 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:50:38.705040 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m15:50:38.705040 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */
alter table "marketing"."public"."freezed_cand1__dbt_tmp" rename to "freezed_cand1"
[0m15:50:38.832942 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:50:38.853923 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: COMMIT
[0m15:50:38.853923 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m15:50:38.854875 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: COMMIT
[0m15:50:38.982543 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:50:38.995507 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m15:50:38.996504 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */
drop view if exists "marketing"."public"."freezed_cand1__dbt_backup" cascade
[0m15:50:39.125807 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:50:39.126808 [debug] [Thread-1 (]: Timing info for model.sakila_dbt.freezed_cand1 (execute): 15:50:37.350235 => 15:50:39.126808
[0m15:50:39.127804 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: Close
[0m15:50:39.128800 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1341fe1a-eec1-4984-8a93-60a813b91064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A78AE265C0>]}
[0m15:50:39.129796 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.freezed_cand1 .......................... [[32mCREATE VIEW[0m in 1.78s]
[0m15:50:39.130830 [debug] [Thread-1 (]: Finished running node model.sakila_dbt.freezed_cand1
[0m15:50:39.131801 [debug] [Thread-1 (]: Began running node model.sakila_dbt.zoho4tik_dbt_model1
[0m15:50:39.132802 [info ] [Thread-1 (]: 2 of 3 START sql table model public.zoho4tik_dbt_model1 ........................ [RUN]
[0m15:50:39.133796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakila_dbt.freezed_cand1, now model.sakila_dbt.zoho4tik_dbt_model1)
[0m15:50:39.134829 [debug] [Thread-1 (]: Began compiling node model.sakila_dbt.zoho4tik_dbt_model1
[0m15:50:39.138819 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakila_dbt.zoho4tik_dbt_model1"
[0m15:50:39.140653 [debug] [Thread-1 (]: Timing info for model.sakila_dbt.zoho4tik_dbt_model1 (compile): 15:50:39.135790 => 15:50:39.140653
[0m15:50:39.140653 [debug] [Thread-1 (]: Began executing node model.sakila_dbt.zoho4tik_dbt_model1
[0m15:50:39.160631 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakila_dbt.zoho4tik_dbt_model1"
[0m15:50:39.162583 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model1"
[0m15:50:39.162583 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model1: BEGIN
[0m15:50:39.163589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:40.249106 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m15:50:40.251101 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model1"
[0m15:50:40.252097 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.zoho4tik_dbt_model1"} */

  
    

  create  table "marketing"."public"."zoho4tik_dbt_model1__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:50:40.382532 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m15:50:40.387571 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model1"
[0m15:50:40.388556 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.zoho4tik_dbt_model1"} */
alter table "marketing"."public"."zoho4tik_dbt_model1" rename to "zoho4tik_dbt_model1__dbt_backup"
[0m15:50:40.516582 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:50:40.524599 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model1"
[0m15:50:40.525551 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.zoho4tik_dbt_model1"} */
alter table "marketing"."public"."zoho4tik_dbt_model1__dbt_tmp" rename to "zoho4tik_dbt_model1"
[0m15:50:40.652178 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:50:40.663150 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model1: COMMIT
[0m15:50:40.664149 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model1"
[0m15:50:40.664149 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model1: COMMIT
[0m15:50:40.792475 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:50:40.801486 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model1"
[0m15:50:40.802441 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.zoho4tik_dbt_model1"} */
drop table if exists "marketing"."public"."zoho4tik_dbt_model1__dbt_backup" cascade
[0m15:50:40.932957 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:50:40.934967 [debug] [Thread-1 (]: Timing info for model.sakila_dbt.zoho4tik_dbt_model1 (execute): 15:50:39.141653 => 15:50:40.934967
[0m15:50:40.935960 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model1: Close
[0m15:50:40.937000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1341fe1a-eec1-4984-8a93-60a813b91064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A78AE0A860>]}
[0m15:50:40.937000 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.zoho4tik_dbt_model1 ................... [[32mSELECT 2[0m in 1.80s]
[0m15:50:40.938994 [debug] [Thread-1 (]: Finished running node model.sakila_dbt.zoho4tik_dbt_model1
[0m15:50:40.940944 [debug] [Thread-1 (]: Began running node model.sakila_dbt.zoho4tik_dbt_model2
[0m15:50:40.941968 [info ] [Thread-1 (]: 3 of 3 START sql view model public.zoho4tik_dbt_model2 ......................... [RUN]
[0m15:50:40.942941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakila_dbt.zoho4tik_dbt_model1, now model.sakila_dbt.zoho4tik_dbt_model2)
[0m15:50:40.943932 [debug] [Thread-1 (]: Began compiling node model.sakila_dbt.zoho4tik_dbt_model2
[0m15:50:40.946955 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakila_dbt.zoho4tik_dbt_model2"
[0m15:50:40.947979 [debug] [Thread-1 (]: Timing info for model.sakila_dbt.zoho4tik_dbt_model2 (compile): 15:50:40.943932 => 15:50:40.947979
[0m15:50:40.947979 [debug] [Thread-1 (]: Began executing node model.sakila_dbt.zoho4tik_dbt_model2
[0m15:50:40.953897 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakila_dbt.zoho4tik_dbt_model2"
[0m15:50:40.954894 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model2"
[0m15:50:40.955891 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model2: BEGIN
[0m15:50:40.956887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:41.971923 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m15:50:41.972970 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model2"
[0m15:50:41.973921 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model2: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.zoho4tik_dbt_model2"} */

  create view "marketing"."public"."zoho4tik_dbt_model2__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "marketing"."public"."zoho4tik_dbt_model1"
where id = 1
  );
[0m15:50:42.099795 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:50:42.102966 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model2"
[0m15:50:42.103967 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model2: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.zoho4tik_dbt_model2"} */
alter table "marketing"."public"."zoho4tik_dbt_model2__dbt_tmp" rename to "zoho4tik_dbt_model2"
[0m15:50:42.227931 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:50:42.234929 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model2: COMMIT
[0m15:50:42.235924 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model2"
[0m15:50:42.236920 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model2: COMMIT
[0m15:50:42.362299 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:50:42.367291 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model2"
[0m15:50:42.368288 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model2: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.zoho4tik_dbt_model2"} */
drop view if exists "marketing"."public"."zoho4tik_dbt_model2__dbt_backup" cascade
[0m15:50:42.493609 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:50:42.496597 [debug] [Thread-1 (]: Timing info for model.sakila_dbt.zoho4tik_dbt_model2 (execute): 15:50:40.948917 => 15:50:42.495599
[0m15:50:42.497593 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model2: Close
[0m15:50:42.499581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1341fe1a-eec1-4984-8a93-60a813b91064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A78AF13FD0>]}
[0m15:50:42.500612 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.zoho4tik_dbt_model2 .................... [[32mCREATE VIEW[0m in 1.56s]
[0m15:50:42.502610 [debug] [Thread-1 (]: Finished running node model.sakila_dbt.zoho4tik_dbt_model2
[0m15:50:42.504569 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:42.505565 [debug] [MainThread]: On master: BEGIN
[0m15:50:42.506558 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:50:43.513965 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m15:50:43.514962 [debug] [MainThread]: On master: COMMIT
[0m15:50:43.515959 [debug] [MainThread]: Using postgres connection "master"
[0m15:50:43.515959 [debug] [MainThread]: On master: COMMIT
[0m15:50:43.640218 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:50:43.640218 [debug] [MainThread]: On master: Close
[0m15:50:43.641247 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:50:43.642256 [debug] [MainThread]: Connection 'list_marketing' was properly closed.
[0m15:50:43.642256 [debug] [MainThread]: Connection 'list_marketing_public' was properly closed.
[0m15:50:43.643211 [debug] [MainThread]: Connection 'model.sakila_dbt.zoho4tik_dbt_model2' was properly closed.
[0m15:50:43.643211 [info ] [MainThread]: 
[0m15:50:43.644249 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 10.47 seconds (10.47s).
[0m15:50:43.645210 [debug] [MainThread]: Command end result
[0m15:50:43.654330 [info ] [MainThread]: 
[0m15:50:43.654330 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:50:43.655324 [info ] [MainThread]: 
[0m15:50:43.656320 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:50:43.657316 [debug] [MainThread]: Command `dbt run` succeeded at 15:50:43.656320 after 10.67 seconds
[0m15:50:43.657316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A787DA2B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A78AF03DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A78AF035B0>]}
[0m15:50:43.657316 [debug] [MainThread]: Flushing usage events
[0m15:51:38.574957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3D13A2B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3D40EAAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3D40EA890>]}


============================== 15:51:38.580250 | ed842e61-2c1c-4f26-856c-2402104ecc33 ==============================
[0m15:51:38.580250 [info ] [MainThread]: Running with dbt=1.6.0
[0m15:51:38.580792 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\as4ti\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\as4ti\\OneDrive\\PowerBI\\Projects\\AgileEnginePBI\\Git_hub\\sakila_dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:51:38.671697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed842e61-2c1c-4f26-856c-2402104ecc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3CD38CBE0>]}
[0m15:51:38.680707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed842e61-2c1c-4f26-856c-2402104ecc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3D4220E20>]}
[0m15:51:38.682661 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m15:51:38.690681 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m15:51:38.730765 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:51:38.731762 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:51:38.737745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed842e61-2c1c-4f26-856c-2402104ecc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3D43ACEE0>]}
[0m15:51:38.746685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed842e61-2c1c-4f26-856c-2402104ecc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3D4278FD0>]}
[0m15:51:38.747682 [info ] [MainThread]: Found 3 models, 6 tests, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m15:51:38.748682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed842e61-2c1c-4f26-856c-2402104ecc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3D4278E80>]}
[0m15:51:38.753013 [info ] [MainThread]: 
[0m15:51:38.755006 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:51:38.757000 [debug] [ThreadPool]: Acquiring new postgres connection 'list_marketing'
[0m15:51:38.773466 [debug] [ThreadPool]: Using postgres connection "list_marketing"
[0m15:51:38.774463 [debug] [ThreadPool]: On list_marketing: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "list_marketing"} */

    select distinct nspname from pg_namespace
  
[0m15:51:38.774463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:39.855258 [debug] [ThreadPool]: SQL status: SELECT 9 in 1.0 seconds
[0m15:51:39.858256 [debug] [ThreadPool]: On list_marketing: Close
[0m15:51:39.863230 [debug] [ThreadPool]: Acquiring new postgres connection 'list_marketing_public'
[0m15:51:39.870199 [debug] [ThreadPool]: Using postgres connection "list_marketing_public"
[0m15:51:39.871206 [debug] [ThreadPool]: On list_marketing_public: BEGIN
[0m15:51:39.872155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:40.872588 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m15:51:40.874159 [debug] [ThreadPool]: Using postgres connection "list_marketing_public"
[0m15:51:40.875162 [debug] [ThreadPool]: On list_marketing_public: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "list_marketing_public"} */
select
      'marketing' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'marketing' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'marketing' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:51:41.007695 [debug] [ThreadPool]: SQL status: SELECT 78 in 0.0 seconds
[0m15:51:41.013722 [debug] [ThreadPool]: On list_marketing_public: ROLLBACK
[0m15:51:41.138125 [debug] [ThreadPool]: On list_marketing_public: Close
[0m15:51:41.153089 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:41.154114 [debug] [MainThread]: On master: BEGIN
[0m15:51:41.155086 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:51:42.210303 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m15:51:42.211349 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:42.213341 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:51:42.354603 [debug] [MainThread]: SQL status: SELECT 31 in 0.0 seconds
[0m15:51:42.360629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed842e61-2c1c-4f26-856c-2402104ecc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3D43AD1E0>]}
[0m15:51:42.361634 [debug] [MainThread]: On master: ROLLBACK
[0m15:51:42.486977 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:42.486977 [debug] [MainThread]: On master: BEGIN
[0m15:51:42.742906 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:51:42.743913 [debug] [MainThread]: On master: COMMIT
[0m15:51:42.743913 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:42.744918 [debug] [MainThread]: On master: COMMIT
[0m15:51:42.873006 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:51:42.874037 [debug] [MainThread]: On master: Close
[0m15:51:42.877002 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:51:42.877998 [info ] [MainThread]: 
[0m15:51:42.884972 [debug] [Thread-1 (]: Began running node model.sakila_dbt.freezed_cand1
[0m15:51:42.886008 [info ] [Thread-1 (]: 1 of 3 START sql view model public.freezed_cand1 ............................... [RUN]
[0m15:51:42.887963 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sakila_dbt.freezed_cand1'
[0m15:51:42.887963 [debug] [Thread-1 (]: Began compiling node model.sakila_dbt.freezed_cand1
[0m15:51:42.894968 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakila_dbt.freezed_cand1"
[0m15:51:42.896813 [debug] [Thread-1 (]: Timing info for model.sakila_dbt.freezed_cand1 (compile): 15:51:42.888961 => 15:51:42.896813
[0m15:51:42.896813 [debug] [Thread-1 (]: Began executing node model.sakila_dbt.freezed_cand1
[0m15:51:42.921405 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakila_dbt.freezed_cand1"
[0m15:51:42.921405 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m15:51:42.921405 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: BEGIN
[0m15:51:42.921405 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:51:43.963911 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m15:51:43.963911 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m15:51:43.963911 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */

  create view "marketing"."public"."freezed_cand1__dbt_tmp"
    
    
  as (
    -- 

select *
from public.freezed_candidate_data a
limit 10
  );
[0m15:51:44.105813 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:51:44.113845 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m15:51:44.113845 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */
alter table "marketing"."public"."freezed_cand1" rename to "freezed_cand1__dbt_backup"
[0m15:51:44.241715 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:51:44.241715 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m15:51:44.241715 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */
alter table "marketing"."public"."freezed_cand1__dbt_tmp" rename to "freezed_cand1"
[0m15:51:44.377990 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:51:44.398926 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: COMMIT
[0m15:51:44.399964 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m15:51:44.400920 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: COMMIT
[0m15:51:44.528564 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:51:44.538757 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m15:51:44.538757 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */
drop view if exists "marketing"."public"."freezed_cand1__dbt_backup" cascade
[0m15:51:44.676118 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:51:44.678127 [debug] [Thread-1 (]: Timing info for model.sakila_dbt.freezed_cand1 (execute): 15:51:42.897867 => 15:51:44.678127
[0m15:51:44.679164 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: Close
[0m15:51:44.681118 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed842e61-2c1c-4f26-856c-2402104ecc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3D44730A0>]}
[0m15:51:44.681118 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.freezed_cand1 .......................... [[32mCREATE VIEW[0m in 1.79s]
[0m15:51:44.682115 [debug] [Thread-1 (]: Finished running node model.sakila_dbt.freezed_cand1
[0m15:51:44.683109 [debug] [Thread-1 (]: Began running node model.sakila_dbt.zoho4tik_dbt_model1
[0m15:51:44.684106 [info ] [Thread-1 (]: 2 of 3 START sql table model public.zoho4tik_dbt_model1 ........................ [RUN]
[0m15:51:44.685102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakila_dbt.freezed_cand1, now model.sakila_dbt.zoho4tik_dbt_model1)
[0m15:51:44.686099 [debug] [Thread-1 (]: Began compiling node model.sakila_dbt.zoho4tik_dbt_model1
[0m15:51:44.690085 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakila_dbt.zoho4tik_dbt_model1"
[0m15:51:44.691082 [debug] [Thread-1 (]: Timing info for model.sakila_dbt.zoho4tik_dbt_model1 (compile): 15:51:44.686099 => 15:51:44.691082
[0m15:51:44.692079 [debug] [Thread-1 (]: Began executing node model.sakila_dbt.zoho4tik_dbt_model1
[0m15:51:44.718733 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakila_dbt.zoho4tik_dbt_model1"
[0m15:51:44.719856 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model1"
[0m15:51:44.721142 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model1: BEGIN
[0m15:51:44.722141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:45.841973 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m15:51:45.843973 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model1"
[0m15:51:45.844974 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.zoho4tik_dbt_model1"} */

  
    

  create  table "marketing"."public"."zoho4tik_dbt_model1__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:51:45.972170 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m15:51:45.977120 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model1"
[0m15:51:45.978115 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.zoho4tik_dbt_model1"} */
alter table "marketing"."public"."zoho4tik_dbt_model1__dbt_tmp" rename to "zoho4tik_dbt_model1"
[0m15:51:46.104252 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:51:46.112500 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model1: COMMIT
[0m15:51:46.113500 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model1"
[0m15:51:46.114492 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model1: COMMIT
[0m15:51:46.241607 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:51:46.250629 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model1"
[0m15:51:46.251617 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.zoho4tik_dbt_model1"} */
drop table if exists "marketing"."public"."zoho4tik_dbt_model1__dbt_backup" cascade
[0m15:51:46.375335 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:51:46.378372 [debug] [Thread-1 (]: Timing info for model.sakila_dbt.zoho4tik_dbt_model1 (execute): 15:51:44.692079 => 15:51:46.378372
[0m15:51:46.379363 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model1: Close
[0m15:51:46.381409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed842e61-2c1c-4f26-856c-2402104ecc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3D44A85B0>]}
[0m15:51:46.382377 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.zoho4tik_dbt_model1 ................... [[32mSELECT 2[0m in 1.70s]
[0m15:51:46.383403 [debug] [Thread-1 (]: Finished running node model.sakila_dbt.zoho4tik_dbt_model1
[0m15:51:46.385379 [debug] [Thread-1 (]: Began running node model.sakila_dbt.zoho4tik_dbt_model2
[0m15:51:46.386362 [info ] [Thread-1 (]: 3 of 3 START sql view model public.zoho4tik_dbt_model2 ......................... [RUN]
[0m15:51:46.388366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sakila_dbt.zoho4tik_dbt_model1, now model.sakila_dbt.zoho4tik_dbt_model2)
[0m15:51:46.389391 [debug] [Thread-1 (]: Began compiling node model.sakila_dbt.zoho4tik_dbt_model2
[0m15:51:46.392339 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakila_dbt.zoho4tik_dbt_model2"
[0m15:51:46.394365 [debug] [Thread-1 (]: Timing info for model.sakila_dbt.zoho4tik_dbt_model2 (compile): 15:51:46.390346 => 15:51:46.393335
[0m15:51:46.394365 [debug] [Thread-1 (]: Began executing node model.sakila_dbt.zoho4tik_dbt_model2
[0m15:51:46.399353 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakila_dbt.zoho4tik_dbt_model2"
[0m15:51:46.400350 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model2"
[0m15:51:46.401307 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model2: BEGIN
[0m15:51:46.401307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:47.424653 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m15:51:47.426692 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model2"
[0m15:51:47.427691 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model2: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.zoho4tik_dbt_model2"} */

  create view "marketing"."public"."zoho4tik_dbt_model2__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "marketing"."public"."zoho4tik_dbt_model1"
where id = 1
  );
[0m15:51:47.556599 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:51:47.560596 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model2"
[0m15:51:47.561595 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model2: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.zoho4tik_dbt_model2"} */
alter table "marketing"."public"."zoho4tik_dbt_model2__dbt_tmp" rename to "zoho4tik_dbt_model2"
[0m15:51:47.688345 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:51:47.693379 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model2: COMMIT
[0m15:51:47.694371 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model2"
[0m15:51:47.695369 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model2: COMMIT
[0m15:51:47.822948 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:51:47.831352 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.zoho4tik_dbt_model2"
[0m15:51:47.832349 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model2: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.zoho4tik_dbt_model2"} */
drop view if exists "marketing"."public"."zoho4tik_dbt_model2__dbt_backup" cascade
[0m15:51:47.959207 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:51:47.961243 [debug] [Thread-1 (]: Timing info for model.sakila_dbt.zoho4tik_dbt_model2 (execute): 15:51:46.395338 => 15:51:47.961243
[0m15:51:47.962239 [debug] [Thread-1 (]: On model.sakila_dbt.zoho4tik_dbt_model2: Close
[0m15:51:47.963203 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed842e61-2c1c-4f26-856c-2402104ecc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3D45037F0>]}
[0m15:51:47.964199 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.zoho4tik_dbt_model2 .................... [[32mCREATE VIEW[0m in 1.57s]
[0m15:51:47.966193 [debug] [Thread-1 (]: Finished running node model.sakila_dbt.zoho4tik_dbt_model2
[0m15:51:47.969180 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:47.970209 [debug] [MainThread]: On master: BEGIN
[0m15:51:47.970209 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:51:48.973598 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m15:51:48.975644 [debug] [MainThread]: On master: COMMIT
[0m15:51:48.976633 [debug] [MainThread]: Using postgres connection "master"
[0m15:51:48.977983 [debug] [MainThread]: On master: COMMIT
[0m15:51:49.102940 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:51:49.103907 [debug] [MainThread]: On master: Close
[0m15:51:49.103907 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:51:49.104909 [debug] [MainThread]: Connection 'list_marketing' was properly closed.
[0m15:51:49.104909 [debug] [MainThread]: Connection 'list_marketing_public' was properly closed.
[0m15:51:49.105863 [debug] [MainThread]: Connection 'model.sakila_dbt.zoho4tik_dbt_model2' was properly closed.
[0m15:51:49.105863 [info ] [MainThread]: 
[0m15:51:49.106857 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 10.35 seconds (10.35s).
[0m15:51:49.107866 [debug] [MainThread]: Command end result
[0m15:51:49.114829 [info ] [MainThread]: 
[0m15:51:49.115826 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:51:49.116826 [info ] [MainThread]: 
[0m15:51:49.117828 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:51:49.119050 [debug] [MainThread]: Command `dbt run` succeeded at 15:51:49.119050 after 10.56 seconds
[0m15:51:49.119050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3D13A2B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3D441AEF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C3D441AF50>]}
[0m15:51:49.120050 [debug] [MainThread]: Flushing usage events
[0m22:40:02.035270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E0B2B2B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E0DFFEB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E0DFFE860>]}


============================== 22:40:02.040293 | 4de1a0d1-d28f-4395-82c3-bbfb1b5e66a0 ==============================
[0m22:40:02.040293 [info ] [MainThread]: Running with dbt=1.6.0
[0m22:40:02.041256 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\as4ti\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\as4ti\\OneDrive\\PowerBI\\Projects\\AgileEnginePBI\\Git_hub\\sakila_dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:40:02.208749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4de1a0d1-d28f-4395-82c3-bbfb1b5e66a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E072DCBE0>]}
[0m22:40:02.217743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4de1a0d1-d28f-4395-82c3-bbfb1b5e66a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E0E138D90>]}
[0m22:40:02.219737 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m22:40:02.229605 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m22:40:02.924613 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 0 files changed.
[0m22:40:02.925610 [debug] [MainThread]: Partial parsing: deleted file: sakila_dbt://models\example\zoho4tik_dbt_model2.sql
[0m22:40:02.925610 [debug] [MainThread]: Partial parsing: deleted file: sakila_dbt://models\example\zoho4tik_dbt_model1.sql
[0m22:40:02.930606 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sakila_dbt.example
[0m22:40:02.935577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4de1a0d1-d28f-4395-82c3-bbfb1b5e66a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E0E2D40D0>]}
[0m22:40:02.956908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4de1a0d1-d28f-4395-82c3-bbfb1b5e66a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E0E188D30>]}
[0m22:40:02.956908 [info ] [MainThread]: Found 1 model, 2 tests, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m22:40:02.957913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4de1a0d1-d28f-4395-82c3-bbfb1b5e66a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E0E188EE0>]}
[0m22:40:02.960314 [info ] [MainThread]: 
[0m22:40:02.961426 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:40:02.963508 [debug] [ThreadPool]: Acquiring new postgres connection 'list_marketing'
[0m22:40:02.973690 [debug] [ThreadPool]: Using postgres connection "list_marketing"
[0m22:40:02.973690 [debug] [ThreadPool]: On list_marketing: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "list_marketing"} */

    select distinct nspname from pg_namespace
  
[0m22:40:02.974814 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:40:04.063087 [debug] [ThreadPool]: SQL status: SELECT 9 in 1.0 seconds
[0m22:40:04.066071 [debug] [ThreadPool]: On list_marketing: Close
[0m22:40:04.069025 [debug] [ThreadPool]: Acquiring new postgres connection 'list_marketing_public'
[0m22:40:04.075046 [debug] [ThreadPool]: Using postgres connection "list_marketing_public"
[0m22:40:04.076339 [debug] [ThreadPool]: On list_marketing_public: BEGIN
[0m22:40:04.076339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:40:05.085939 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m22:40:05.085939 [debug] [ThreadPool]: Using postgres connection "list_marketing_public"
[0m22:40:05.086936 [debug] [ThreadPool]: On list_marketing_public: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "list_marketing_public"} */
select
      'marketing' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'marketing' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'marketing' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:40:05.227027 [debug] [ThreadPool]: SQL status: SELECT 78 in 0.0 seconds
[0m22:40:05.230017 [debug] [ThreadPool]: On list_marketing_public: ROLLBACK
[0m22:40:05.352879 [debug] [ThreadPool]: On list_marketing_public: Close
[0m22:40:05.365835 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:05.366832 [debug] [MainThread]: On master: BEGIN
[0m22:40:05.366832 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:40:06.376526 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m22:40:06.378525 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:06.379522 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:40:06.535595 [debug] [MainThread]: SQL status: SELECT 31 in 0.0 seconds
[0m22:40:06.540624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4de1a0d1-d28f-4395-82c3-bbfb1b5e66a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E0E31C610>]}
[0m22:40:06.542580 [debug] [MainThread]: On master: ROLLBACK
[0m22:40:06.667241 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:06.667241 [debug] [MainThread]: On master: BEGIN
[0m22:40:06.914939 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:40:06.915905 [debug] [MainThread]: On master: COMMIT
[0m22:40:06.916901 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:06.917898 [debug] [MainThread]: On master: COMMIT
[0m22:40:07.042169 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:40:07.043170 [debug] [MainThread]: On master: Close
[0m22:40:07.045114 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:40:07.046110 [info ] [MainThread]: 
[0m22:40:07.052448 [debug] [Thread-1 (]: Began running node model.sakila_dbt.freezed_cand1
[0m22:40:07.053447 [info ] [Thread-1 (]: 1 of 1 START sql view model public.freezed_cand1 ............................... [RUN]
[0m22:40:07.055438 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sakila_dbt.freezed_cand1'
[0m22:40:07.055438 [debug] [Thread-1 (]: Began compiling node model.sakila_dbt.freezed_cand1
[0m22:40:07.066513 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakila_dbt.freezed_cand1"
[0m22:40:07.067509 [debug] [Thread-1 (]: Timing info for model.sakila_dbt.freezed_cand1 (compile): 22:40:07.056434 => 22:40:07.067509
[0m22:40:07.068544 [debug] [Thread-1 (]: Began executing node model.sakila_dbt.freezed_cand1
[0m22:40:07.109826 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakila_dbt.freezed_cand1"
[0m22:40:07.110823 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m22:40:07.111820 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: BEGIN
[0m22:40:07.111820 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:40:08.137649 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m22:40:08.139642 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m22:40:08.140621 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */

  create view "marketing"."public"."freezed_cand1__dbt_tmp"
    
    
  as (
    -- 

select *
from public.freezed_candidate_data a
limit 10
  );
[0m22:40:08.341610 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m22:40:08.354533 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m22:40:08.355546 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */
alter table "marketing"."public"."freezed_cand1" rename to "freezed_cand1__dbt_backup"
[0m22:40:08.484354 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:40:08.491376 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m22:40:08.493330 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */
alter table "marketing"."public"."freezed_cand1__dbt_tmp" rename to "freezed_cand1"
[0m22:40:08.620156 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m22:40:08.640140 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: COMMIT
[0m22:40:08.641108 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m22:40:08.641108 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: COMMIT
[0m22:40:08.769098 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m22:40:08.780107 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m22:40:08.780107 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */
drop view if exists "marketing"."public"."freezed_cand1__dbt_backup" cascade
[0m22:40:08.914251 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m22:40:08.918243 [debug] [Thread-1 (]: Timing info for model.sakila_dbt.freezed_cand1 (execute): 22:40:07.069503 => 22:40:08.917244
[0m22:40:08.919248 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: Close
[0m22:40:08.920786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4de1a0d1-d28f-4395-82c3-bbfb1b5e66a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E0E3C3430>]}
[0m22:40:08.922425 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.freezed_cand1 .......................... [[32mCREATE VIEW[0m in 1.87s]
[0m22:40:08.924469 [debug] [Thread-1 (]: Finished running node model.sakila_dbt.freezed_cand1
[0m22:40:08.927218 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:08.928205 [debug] [MainThread]: On master: BEGIN
[0m22:40:08.928205 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:40:10.029079 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m22:40:10.031057 [debug] [MainThread]: On master: COMMIT
[0m22:40:10.032065 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:10.033007 [debug] [MainThread]: On master: COMMIT
[0m22:40:10.161118 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:40:10.162120 [debug] [MainThread]: On master: Close
[0m22:40:10.164114 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:40:10.166110 [debug] [MainThread]: Connection 'list_marketing' was properly closed.
[0m22:40:10.167157 [debug] [MainThread]: Connection 'list_marketing_public' was properly closed.
[0m22:40:10.168101 [debug] [MainThread]: Connection 'model.sakila_dbt.freezed_cand1' was properly closed.
[0m22:40:10.177504 [info ] [MainThread]: 
[0m22:40:10.178484 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.21 seconds (7.21s).
[0m22:40:10.179475 [debug] [MainThread]: Command end result
[0m22:40:10.187417 [info ] [MainThread]: 
[0m22:40:10.188414 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:40:10.189412 [info ] [MainThread]: 
[0m22:40:10.190407 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:40:10.191823 [debug] [MainThread]: Command `dbt run` succeeded at 22:40:10.191823 after 8.18 seconds
[0m22:40:10.192852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E0B2B2B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E0E3C3B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E0E3B1CF0>]}
[0m22:40:10.193820 [debug] [MainThread]: Flushing usage events
[0m22:52:42.027465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177D4D82AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177D7ACAA40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177D7ACA7A0>]}


============================== 22:52:42.030455 | 1209b2ab-d23c-4027-a6fc-69b79d72da5e ==============================
[0m22:52:42.030455 [info ] [MainThread]: Running with dbt=1.6.0
[0m22:52:42.032462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\as4ti\\.dbt', 'log_path': 'C:\\Users\\as4ti\\OneDrive\\PowerBI\\Projects\\AgileEnginePBI\\Git_hub\\sakila_dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:52:42.123381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1209b2ab-d23c-4027-a6fc-69b79d72da5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177D0E1CBE0>]}
[0m22:52:42.130359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1209b2ab-d23c-4027-a6fc-69b79d72da5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177D7C00CD0>]}
[0m22:52:42.132352 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m22:52:42.139342 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m22:52:42.146305 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:52:42.147277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1209b2ab-d23c-4027-a6fc-69b79d72da5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177D7C03850>]}
[0m22:52:42.155270 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading sakila_dbt: test_dbt1\schema.yml - Runtime Error
    Syntax error near line 4
    ------------------------------
    1  | -- {{ config(materialized='view') }}
    2  | 
    3  | 
    4  | version: 1
    5  | 
    6  | models:
    7  |   - name: freezed_cand1
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 4, column 8
[0m22:52:42.156405 [debug] [MainThread]: Command `dbt run` failed at 22:52:42.156405 after 0.14 seconds
[0m22:52:42.156405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177D4D82AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177D7D23BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177D7D23AF0>]}
[0m22:52:42.156405 [debug] [MainThread]: Flushing usage events
[0m22:53:55.040907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202047E2B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002020752AAA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002020752A800>]}


============================== 22:53:55.045046 | 6501d395-8fba-421a-bfc3-531bd8ab2b96 ==============================
[0m22:53:55.045046 [info ] [MainThread]: Running with dbt=1.6.0
[0m22:53:55.045976 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\as4ti\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\as4ti\\OneDrive\\PowerBI\\Projects\\AgileEnginePBI\\Git_hub\\sakila_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:53:55.135881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6501d395-8fba-421a-bfc3-531bd8ab2b96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002020080CBE0>]}
[0m22:53:55.143156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6501d395-8fba-421a-bfc3-531bd8ab2b96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020207660C70>]}
[0m22:53:55.144633 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m22:53:55.151614 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m22:53:55.158590 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:53:55.159511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6501d395-8fba-421a-bfc3-531bd8ab2b96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202076634F0>]}
[0m22:53:55.164535 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading sakila_dbt: test_dbt1\schema.yml - Runtime Error
    Syntax error near line 4
    ------------------------------
    1  | -- {{ config(materialized='view') }}
    2  | 
    3  | 
    4  | version: 1
    5  | 
    6  | models:
    7  |   - name: freezed_cand1
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 4, column 8
[0m22:53:55.165528 [debug] [MainThread]: Command `dbt run` failed at 22:53:55.165528 after 0.14 seconds
[0m22:53:55.166529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202047E2B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020207783BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020207783A90>]}
[0m22:53:55.167487 [debug] [MainThread]: Flushing usage events
[0m22:55:10.738567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B57F2B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B853EA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B853E830>]}


============================== 22:55:10.742530 | 8e67d64f-1ed2-43c4-a7db-a6de23d1b7f9 ==============================
[0m22:55:10.742530 [info ] [MainThread]: Running with dbt=1.6.0
[0m22:55:10.743542 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\as4ti\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\as4ti\\OneDrive\\PowerBI\\Projects\\AgileEnginePBI\\Git_hub\\sakila_dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:55:10.827828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e67d64f-1ed2-43c4-a7db-a6de23d1b7f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B180CBE0>]}
[0m22:55:10.835801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e67d64f-1ed2-43c4-a7db-a6de23d1b7f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B8678E80>]}
[0m22:55:10.836799 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m22:55:10.843813 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m22:55:10.850791 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:55:10.850791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8e67d64f-1ed2-43c4-a7db-a6de23d1b7f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B867B490>]}
[0m22:55:10.857888 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading sakila_dbt: test_dbt1\schema.yml - Runtime Error
    Syntax error near line 4
    ------------------------------
    1  | -- {{ config(materialized='view') }}
    2  | 
    3  | 
    4  | version: 1
    5  | 
    6  | models:
    7  |   - name: freezed_cand1
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 4, column 8
[0m22:55:10.859339 [debug] [MainThread]: Command `dbt run` failed at 22:55:10.859339 after 0.13 seconds
[0m22:55:10.859339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B57F2B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B878FC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8B878FAC0>]}
[0m22:55:10.860831 [debug] [MainThread]: Flushing usage events
[0m22:57:35.676657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C487FA2B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C48ACEAA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C48ACEA830>]}


============================== 22:57:35.680747 | d61c56d0-fcfe-4b2c-b996-7941a284578e ==============================
[0m22:57:35.680747 [info ] [MainThread]: Running with dbt=1.6.0
[0m22:57:35.682805 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\as4ti\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\as4ti\\OneDrive\\PowerBI\\Projects\\AgileEnginePBI\\Git_hub\\sakila_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:57:35.771638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd61c56d0-fcfe-4b2c-b996-7941a284578e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C48401CBE0>]}
[0m22:57:35.779660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd61c56d0-fcfe-4b2c-b996-7941a284578e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C48AE24C40>]}
[0m22:57:35.780656 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m22:57:35.787584 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m22:57:35.794604 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:57:35.795559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd61c56d0-fcfe-4b2c-b996-7941a284578e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C48AE27490>]}
[0m22:57:35.800540 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading sakila_dbt: test_dbt1\schema.yml - Runtime Error
    Syntax error near line 4
    ------------------------------
    1  | -- {{ config(materialized='view') }}
    2  | 
    3  | 
    4  | version: 1
    5  | 
    6  | models:
    7  |   - name: freezed_cand1
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 4, column 8
[0m22:57:35.801537 [debug] [MainThread]: Command `dbt run` failed at 22:57:35.801537 after 0.14 seconds
[0m22:57:35.802541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C487FA2B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C48AF3FC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C48AF3FAC0>]}
[0m22:57:35.802541 [debug] [MainThread]: Flushing usage events
[0m22:58:01.054689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B65E982B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6616DAAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6616DA890>]}


============================== 22:58:01.058672 | 585ec9b7-4435-4193-991d-0236df6fd949 ==============================
[0m22:58:01.058672 [info ] [MainThread]: Running with dbt=1.6.0
[0m22:58:01.059668 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\as4ti\\OneDrive\\PowerBI\\Projects\\AgileEnginePBI\\Git_hub\\sakila_dbt\\logs', 'profiles_dir': 'C:\\Users\\as4ti\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:58:01.147698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '585ec9b7-4435-4193-991d-0236df6fd949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B65A97CBE0>]}
[0m22:58:01.155673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '585ec9b7-4435-4193-991d-0236df6fd949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B661810CA0>]}
[0m22:58:01.156670 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m22:58:01.163646 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m22:58:01.170550 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:58:01.170550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '585ec9b7-4435-4193-991d-0236df6fd949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B661813490>]}
[0m22:58:01.176633 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading sakila_dbt: test_dbt1\schema.yml - Runtime Error
    Syntax error near line 4
    ------------------------------
    1  | -- {{ config(materialized='view') }}
    2  | 
    3  | 
    4  | version: 1
    5  | 
    6  | models:
    7  |   - name: freezed_cand1
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 4, column 8
[0m22:58:01.177630 [debug] [MainThread]: Command `dbt run` failed at 22:58:01.177630 after 0.13 seconds
[0m22:58:01.178627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B65E982B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B661933BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B661933AF0>]}
[0m22:58:01.178627 [debug] [MainThread]: Flushing usage events
[0m23:04:38.934996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEF70E2B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEF9E2AB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEF9E2A860>]}


============================== 23:04:38.937986 | 4eff0a53-5e41-4fed-a842-a60170504778 ==============================
[0m23:04:38.937986 [info ] [MainThread]: Running with dbt=1.6.0
[0m23:04:38.938983 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\as4ti\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\as4ti\\OneDrive\\PowerBI\\Projects\\AgileEnginePBI\\Git_hub\\sakila_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:04:39.029883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4eff0a53-5e41-4fed-a842-a60170504778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEF311CBE0>]}
[0m23:04:39.037858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4eff0a53-5e41-4fed-a842-a60170504778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEF9F64D30>]}
[0m23:04:39.039850 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m23:04:39.045830 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m23:04:39.052806 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:04:39.053804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4eff0a53-5e41-4fed-a842-a60170504778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEF9F674C0>]}
[0m23:04:39.666469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4eff0a53-5e41-4fed-a842-a60170504778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEFA0589A0>]}
[0m23:04:39.674407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4eff0a53-5e41-4fed-a842-a60170504778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEFA10D6C0>]}
[0m23:04:39.675405 [info ] [MainThread]: Found 1 model, 2 tests, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m23:04:39.676403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4eff0a53-5e41-4fed-a842-a60170504778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEFA10F4C0>]}
[0m23:04:39.677437 [info ] [MainThread]: 
[0m23:04:39.678437 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:04:39.679390 [debug] [ThreadPool]: Acquiring new postgres connection 'list_marketing'
[0m23:04:39.689563 [debug] [ThreadPool]: Using postgres connection "list_marketing"
[0m23:04:39.689563 [debug] [ThreadPool]: On list_marketing: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "list_marketing"} */

    select distinct nspname from pg_namespace
  
[0m23:04:39.690564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:04:40.803856 [debug] [ThreadPool]: SQL status: SELECT 9 in 1.0 seconds
[0m23:04:40.806495 [debug] [ThreadPool]: On list_marketing: Close
[0m23:04:40.810479 [debug] [ThreadPool]: Acquiring new postgres connection 'list_marketing_public'
[0m23:04:40.816455 [debug] [ThreadPool]: Using postgres connection "list_marketing_public"
[0m23:04:40.817459 [debug] [ThreadPool]: On list_marketing_public: BEGIN
[0m23:04:40.817459 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:04:41.813253 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m23:04:41.814256 [debug] [ThreadPool]: Using postgres connection "list_marketing_public"
[0m23:04:41.816248 [debug] [ThreadPool]: On list_marketing_public: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "list_marketing_public"} */
select
      'marketing' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'marketing' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'marketing' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:04:41.949532 [debug] [ThreadPool]: SQL status: SELECT 78 in 0.0 seconds
[0m23:04:41.951572 [debug] [ThreadPool]: On list_marketing_public: ROLLBACK
[0m23:04:42.069114 [debug] [ThreadPool]: On list_marketing_public: Close
[0m23:04:42.082101 [debug] [MainThread]: Using postgres connection "master"
[0m23:04:42.083107 [debug] [MainThread]: On master: BEGIN
[0m23:04:42.084060 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:04:43.052244 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m23:04:43.054198 [debug] [MainThread]: Using postgres connection "master"
[0m23:04:43.055238 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:04:43.195873 [debug] [MainThread]: SQL status: SELECT 31 in 0.0 seconds
[0m23:04:43.200911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4eff0a53-5e41-4fed-a842-a60170504778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEFA0EBB80>]}
[0m23:04:43.201910 [debug] [MainThread]: On master: ROLLBACK
[0m23:04:43.319475 [debug] [MainThread]: Using postgres connection "master"
[0m23:04:43.320668 [debug] [MainThread]: On master: BEGIN
[0m23:04:43.556959 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:04:43.558010 [debug] [MainThread]: On master: COMMIT
[0m23:04:43.559953 [debug] [MainThread]: Using postgres connection "master"
[0m23:04:43.560983 [debug] [MainThread]: On master: COMMIT
[0m23:04:43.678183 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:04:43.679119 [debug] [MainThread]: On master: Close
[0m23:04:43.680116 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:04:43.680116 [info ] [MainThread]: 
[0m23:04:43.684102 [debug] [Thread-1 (]: Began running node model.sakila_dbt.freezed_cand1
[0m23:04:43.684102 [info ] [Thread-1 (]: 1 of 1 START sql view model public.freezed_cand1 ............................... [RUN]
[0m23:04:43.685109 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sakila_dbt.freezed_cand1'
[0m23:04:43.686134 [debug] [Thread-1 (]: Began compiling node model.sakila_dbt.freezed_cand1
[0m23:04:43.691116 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakila_dbt.freezed_cand1"
[0m23:04:43.693162 [debug] [Thread-1 (]: Timing info for model.sakila_dbt.freezed_cand1 (compile): 23:04:43.686134 => 23:04:43.692121
[0m23:04:43.693162 [debug] [Thread-1 (]: Began executing node model.sakila_dbt.freezed_cand1
[0m23:04:43.724640 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakila_dbt.freezed_cand1"
[0m23:04:43.725634 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m23:04:43.726592 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: BEGIN
[0m23:04:43.726592 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:04:44.703878 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m23:04:44.704940 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m23:04:44.706913 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */

  create view "marketing"."public"."freezed_cand1__dbt_tmp"
    
    
  as (
    select *
from public.freezed_candidate_data a
limit 10
  );
[0m23:04:44.885379 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:04:44.897447 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m23:04:44.898405 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */
alter table "marketing"."public"."freezed_cand1" rename to "freezed_cand1__dbt_backup"
[0m23:04:45.021798 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:04:45.028780 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m23:04:45.029777 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */
alter table "marketing"."public"."freezed_cand1__dbt_tmp" rename to "freezed_cand1"
[0m23:04:45.151432 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:04:45.171417 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: COMMIT
[0m23:04:45.172409 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m23:04:45.172409 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: COMMIT
[0m23:04:45.296304 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:04:45.306275 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m23:04:45.306275 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */
drop view if exists "marketing"."public"."freezed_cand1__dbt_backup" cascade
[0m23:04:45.436964 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:04:45.440948 [debug] [Thread-1 (]: Timing info for model.sakila_dbt.freezed_cand1 (execute): 23:04:43.693162 => 23:04:45.439950
[0m23:04:45.441951 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: Close
[0m23:04:45.443901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4eff0a53-5e41-4fed-a842-a60170504778', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEFA201C90>]}
[0m23:04:45.445938 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.freezed_cand1 .......................... [[32mCREATE VIEW[0m in 1.76s]
[0m23:04:45.447927 [debug] [Thread-1 (]: Finished running node model.sakila_dbt.freezed_cand1
[0m23:04:45.450879 [debug] [MainThread]: Using postgres connection "master"
[0m23:04:45.451876 [debug] [MainThread]: On master: BEGIN
[0m23:04:45.451876 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:04:46.560668 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m23:04:46.561675 [debug] [MainThread]: On master: COMMIT
[0m23:04:46.563664 [debug] [MainThread]: Using postgres connection "master"
[0m23:04:46.564664 [debug] [MainThread]: On master: COMMIT
[0m23:04:46.683202 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:04:46.685227 [debug] [MainThread]: On master: Close
[0m23:04:46.687225 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:04:46.688218 [debug] [MainThread]: Connection 'list_marketing' was properly closed.
[0m23:04:46.689227 [debug] [MainThread]: Connection 'list_marketing_public' was properly closed.
[0m23:04:46.690178 [debug] [MainThread]: Connection 'model.sakila_dbt.freezed_cand1' was properly closed.
[0m23:04:46.691800 [info ] [MainThread]: 
[0m23:04:46.692844 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.01 seconds (7.01s).
[0m23:04:46.693801 [debug] [MainThread]: Command end result
[0m23:04:46.700765 [info ] [MainThread]: 
[0m23:04:46.701811 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:04:46.702795 [info ] [MainThread]: 
[0m23:04:46.702795 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:04:46.703794 [debug] [MainThread]: Command `dbt run` succeeded at 23:04:46.703794 after 7.78 seconds
[0m23:04:46.704842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEF70E2B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEF9F64D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEFA136FE0>]}
[0m23:04:46.704842 [debug] [MainThread]: Flushing usage events
[0m23:06:04.937040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192A2C72B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192A59BAAA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192A59BA800>]}


============================== 23:06:04.941032 | ce2919ce-b830-4a1e-b88d-0a5bbab2d0e0 ==============================
[0m23:06:04.941032 [info ] [MainThread]: Running with dbt=1.6.0
[0m23:06:04.942025 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\as4ti\\OneDrive\\PowerBI\\Projects\\AgileEnginePBI\\Git_hub\\sakila_dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\as4ti\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:06:05.025255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce2919ce-b830-4a1e-b88d-0a5bbab2d0e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001929EC8CBE0>]}
[0m23:06:05.034262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce2919ce-b830-4a1e-b88d-0a5bbab2d0e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192A5AF4D30>]}
[0m23:06:05.035306 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m23:06:05.044775 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m23:06:05.056359 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading sakila_dbt: test_dbt1\schema.yml - Runtime Error
    Syntax error near line 4
    ------------------------------
    1  | -- {{ config(materialized='view') }}
    2  | 
    3  | 
    4  | version: 2
    5  | 
    6  | models:
    7  |   - name: freezed_cand1
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 4, column 8
[0m23:06:05.057333 [debug] [MainThread]: Command `dbt run` failed at 23:06:05.057333 after 0.13 seconds
[0m23:06:05.058324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192A2C72B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192A5C2A5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192A5C2A590>]}
[0m23:06:05.058324 [debug] [MainThread]: Flushing usage events
[0m23:06:41.870579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275A77D2B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275AA51AB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275AA51A8C0>]}


============================== 23:06:41.873612 | a41a5e30-3d1a-4be0-8c73-4ab067ce9e40 ==============================
[0m23:06:41.873612 [info ] [MainThread]: Running with dbt=1.6.0
[0m23:06:41.874607 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\as4ti\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\as4ti\\OneDrive\\PowerBI\\Projects\\AgileEnginePBI\\Git_hub\\sakila_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:06:41.964495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a41a5e30-3d1a-4be0-8c73-4ab067ce9e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275A386CBE0>]}
[0m23:06:41.972055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a41a5e30-3d1a-4be0-8c73-4ab067ce9e40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275AA654D90>]}
[0m23:06:41.973011 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m23:06:41.981022 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m23:06:41.991945 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading sakila_dbt: test_dbt1\schema.yml - Runtime Error
    Syntax error near line 4
    ------------------------------
    1  | -- {{ config(materialized='view') }}
    2  | 
    3  | 
    4  | version: 2
    5  | 
    6  | models:
    7  |   - name: freezed_cand1
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 4, column 8
[0m23:06:41.992998 [debug] [MainThread]: Command `dbt run` failed at 23:06:41.992998 after 0.13 seconds
[0m23:06:41.993973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275A77D2B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275AA78A620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275AA78A5F0>]}
[0m23:06:41.994970 [debug] [MainThread]: Flushing usage events
[0m23:06:58.662249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD74CC2B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD77A0AB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD77A0A8C0>]}


============================== 23:06:58.666238 | 7658db26-ea78-4078-9abe-75d73a3515cc ==============================
[0m23:06:58.666238 [info ] [MainThread]: Running with dbt=1.6.0
[0m23:06:58.667919 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\as4ti\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\as4ti\\OneDrive\\PowerBI\\Projects\\AgileEnginePBI\\Git_hub\\sakila_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:06:58.753801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7658db26-ea78-4078-9abe-75d73a3515cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD70CECBE0>]}
[0m23:06:58.761774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7658db26-ea78-4078-9abe-75d73a3515cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD77B44E50>]}
[0m23:06:58.764067 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m23:06:58.771467 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m23:06:58.808679 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:06:58.809752 [debug] [MainThread]: Partial parsing: updated file: sakila_dbt://models\test_dbt1\freezed_cand1.sql
[0m23:06:58.866350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7658db26-ea78-4078-9abe-75d73a3515cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD77D99690>]}
[0m23:06:58.874324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7658db26-ea78-4078-9abe-75d73a3515cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD77C8BB20>]}
[0m23:06:58.875320 [info ] [MainThread]: Found 1 model, 2 tests, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m23:06:58.876317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7658db26-ea78-4078-9abe-75d73a3515cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD77C8BAC0>]}
[0m23:06:58.878310 [info ] [MainThread]: 
[0m23:06:58.879310 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:06:58.880305 [debug] [ThreadPool]: Acquiring new postgres connection 'list_marketing'
[0m23:06:58.890818 [debug] [ThreadPool]: Using postgres connection "list_marketing"
[0m23:06:58.891815 [debug] [ThreadPool]: On list_marketing: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "list_marketing"} */

    select distinct nspname from pg_namespace
  
[0m23:06:58.891815 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:06:59.963293 [debug] [ThreadPool]: SQL status: SELECT 9 in 1.0 seconds
[0m23:06:59.967285 [debug] [ThreadPool]: On list_marketing: Close
[0m23:06:59.970279 [debug] [ThreadPool]: Acquiring new postgres connection 'list_marketing_public'
[0m23:06:59.975262 [debug] [ThreadPool]: Using postgres connection "list_marketing_public"
[0m23:06:59.976262 [debug] [ThreadPool]: On list_marketing_public: BEGIN
[0m23:06:59.977257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:07:01.126683 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m23:07:01.127730 [debug] [ThreadPool]: Using postgres connection "list_marketing_public"
[0m23:07:01.129681 [debug] [ThreadPool]: On list_marketing_public: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "list_marketing_public"} */
select
      'marketing' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'marketing' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'marketing' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:07:01.255726 [debug] [ThreadPool]: SQL status: SELECT 78 in 0.0 seconds
[0m23:07:01.260710 [debug] [ThreadPool]: On list_marketing_public: ROLLBACK
[0m23:07:01.381582 [debug] [ThreadPool]: On list_marketing_public: Close
[0m23:07:01.398025 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:01.399023 [debug] [MainThread]: On master: BEGIN
[0m23:07:01.399023 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:07:02.355283 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m23:07:02.356327 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:02.358280 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:07:02.498826 [debug] [MainThread]: SQL status: SELECT 31 in 0.0 seconds
[0m23:07:02.503814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7658db26-ea78-4078-9abe-75d73a3515cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD77DD6830>]}
[0m23:07:02.504811 [debug] [MainThread]: On master: ROLLBACK
[0m23:07:02.626194 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:02.626194 [debug] [MainThread]: On master: BEGIN
[0m23:07:02.863929 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:07:02.865898 [debug] [MainThread]: On master: COMMIT
[0m23:07:02.866858 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:02.867884 [debug] [MainThread]: On master: COMMIT
[0m23:07:02.986996 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:07:02.989042 [debug] [MainThread]: On master: Close
[0m23:07:02.990990 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:07:02.992987 [info ] [MainThread]: 
[0m23:07:02.998964 [debug] [Thread-1 (]: Began running node model.sakila_dbt.freezed_cand1
[0m23:07:02.999991 [info ] [Thread-1 (]: 1 of 1 START sql view model public.freezed_cand1 ............................... [RUN]
[0m23:07:03.000995 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sakila_dbt.freezed_cand1'
[0m23:07:03.001987 [debug] [Thread-1 (]: Began compiling node model.sakila_dbt.freezed_cand1
[0m23:07:03.010126 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakila_dbt.freezed_cand1"
[0m23:07:03.012080 [debug] [Thread-1 (]: Timing info for model.sakila_dbt.freezed_cand1 (compile): 23:07:03.002988 => 23:07:03.011080
[0m23:07:03.012080 [debug] [Thread-1 (]: Began executing node model.sakila_dbt.freezed_cand1
[0m23:07:03.051822 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakila_dbt.freezed_cand1"
[0m23:07:03.052819 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m23:07:03.053816 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: BEGIN
[0m23:07:03.053816 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:07:04.027654 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m23:07:04.028650 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m23:07:04.030645 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */

  create view "marketing"."public"."freezed_cand1__dbt_tmp"
    
    
  as (
    -- 

select *
from public.freezed_candidate_data a
limit 10
  );
[0m23:07:04.161640 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:07:04.166673 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m23:07:04.167658 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */
alter table "marketing"."public"."freezed_cand1" rename to "freezed_cand1__dbt_backup"
[0m23:07:04.289993 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:07:04.298003 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m23:07:04.298003 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */
alter table "marketing"."public"."freezed_cand1__dbt_tmp" rename to "freezed_cand1"
[0m23:07:04.419693 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:07:04.441663 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: COMMIT
[0m23:07:04.441663 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m23:07:04.442628 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: COMMIT
[0m23:07:04.564213 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:07:04.578239 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m23:07:04.579231 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */
drop view if exists "marketing"."public"."freezed_cand1__dbt_backup" cascade
[0m23:07:04.701917 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:07:04.703944 [debug] [Thread-1 (]: Timing info for model.sakila_dbt.freezed_cand1 (execute): 23:07:03.013070 => 23:07:04.703944
[0m23:07:04.704935 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: Close
[0m23:07:04.705902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7658db26-ea78-4078-9abe-75d73a3515cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD77E89B70>]}
[0m23:07:04.705902 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.freezed_cand1 .......................... [[32mCREATE VIEW[0m in 1.70s]
[0m23:07:04.707936 [debug] [Thread-1 (]: Finished running node model.sakila_dbt.freezed_cand1
[0m23:07:04.709888 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:04.709888 [debug] [MainThread]: On master: BEGIN
[0m23:07:04.709888 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:07:05.758675 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m23:07:05.760714 [debug] [MainThread]: On master: COMMIT
[0m23:07:05.761722 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:05.762668 [debug] [MainThread]: On master: COMMIT
[0m23:07:05.884683 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:07:05.886700 [debug] [MainThread]: On master: Close
[0m23:07:05.889191 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:07:05.890484 [debug] [MainThread]: Connection 'list_marketing' was properly closed.
[0m23:07:05.891488 [debug] [MainThread]: Connection 'list_marketing_public' was properly closed.
[0m23:07:05.892484 [debug] [MainThread]: Connection 'model.sakila_dbt.freezed_cand1' was properly closed.
[0m23:07:05.893480 [info ] [MainThread]: 
[0m23:07:05.894476 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.01 seconds (7.01s).
[0m23:07:05.896470 [debug] [MainThread]: Command end result
[0m23:07:05.903446 [info ] [MainThread]: 
[0m23:07:05.904442 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:07:05.904442 [info ] [MainThread]: 
[0m23:07:05.905439 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:07:05.906435 [debug] [MainThread]: Command `dbt run` succeeded at 23:07:05.905439 after 7.25 seconds
[0m23:07:05.907165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD74CC2B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD77B44E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD77E54430>]}
[0m23:07:05.907165 [debug] [MainThread]: Flushing usage events
[0m23:10:06.541503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C52F12BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C55C5AB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C55C5A8F0>]}


============================== 23:10:06.545534 | bf90d14d-2c9c-433b-82d2-ce8e329bda4f ==============================
[0m23:10:06.545534 [info ] [MainThread]: Running with dbt=1.6.0
[0m23:10:06.546488 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\as4ti\\.dbt', 'log_path': 'C:\\Users\\as4ti\\OneDrive\\PowerBI\\Projects\\AgileEnginePBI\\Git_hub\\sakila_dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:10:06.636795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf90d14d-2c9c-433b-82d2-ce8e329bda4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C4EEFCBE0>]}
[0m23:10:06.643936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf90d14d-2c9c-433b-82d2-ce8e329bda4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C55D94E80>]}
[0m23:10:06.644981 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m23:10:06.652474 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m23:10:06.689377 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:10:06.690421 [debug] [MainThread]: Partial parsing: updated file: sakila_dbt://models\test_dbt1\freezed_cand1.sql
[0m23:10:06.746569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf90d14d-2c9c-433b-82d2-ce8e329bda4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C55FF16C0>]}
[0m23:10:06.755506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf90d14d-2c9c-433b-82d2-ce8e329bda4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C55ED8E50>]}
[0m23:10:06.755506 [info ] [MainThread]: Found 1 model, 2 tests, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m23:10:06.756639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf90d14d-2c9c-433b-82d2-ce8e329bda4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C55EDBC40>]}
[0m23:10:06.758039 [info ] [MainThread]: 
[0m23:10:06.759039 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:10:06.761033 [debug] [ThreadPool]: Acquiring new postgres connection 'list_marketing'
[0m23:10:06.770007 [debug] [ThreadPool]: Using postgres connection "list_marketing"
[0m23:10:06.771035 [debug] [ThreadPool]: On list_marketing: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "list_marketing"} */

    select distinct nspname from pg_namespace
  
[0m23:10:06.771035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:10:07.830228 [debug] [ThreadPool]: SQL status: SELECT 9 in 1.0 seconds
[0m23:10:07.831229 [debug] [ThreadPool]: On list_marketing: Close
[0m23:10:07.834260 [debug] [ThreadPool]: Acquiring new postgres connection 'list_marketing_public'
[0m23:10:07.839203 [debug] [ThreadPool]: Using postgres connection "list_marketing_public"
[0m23:10:07.840201 [debug] [ThreadPool]: On list_marketing_public: BEGIN
[0m23:10:07.841195 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:10:08.837623 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m23:10:08.837623 [debug] [ThreadPool]: Using postgres connection "list_marketing_public"
[0m23:10:08.838659 [debug] [ThreadPool]: On list_marketing_public: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "list_marketing_public"} */
select
      'marketing' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'marketing' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'marketing' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:10:08.960500 [debug] [ThreadPool]: SQL status: SELECT 78 in 0.0 seconds
[0m23:10:08.964533 [debug] [ThreadPool]: On list_marketing_public: ROLLBACK
[0m23:10:09.083263 [debug] [ThreadPool]: On list_marketing_public: Close
[0m23:10:09.101250 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:09.101250 [debug] [MainThread]: On master: BEGIN
[0m23:10:09.102245 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:10:10.068545 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m23:10:10.070596 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:10.071600 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:10:10.205903 [debug] [MainThread]: SQL status: SELECT 31 in 0.0 seconds
[0m23:10:10.210967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf90d14d-2c9c-433b-82d2-ce8e329bda4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C5602A860>]}
[0m23:10:10.212911 [debug] [MainThread]: On master: ROLLBACK
[0m23:10:10.331392 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:10.331392 [debug] [MainThread]: On master: BEGIN
[0m23:10:10.567864 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:10:10.568910 [debug] [MainThread]: On master: COMMIT
[0m23:10:10.570862 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:10.571861 [debug] [MainThread]: On master: COMMIT
[0m23:10:10.691357 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:10:10.692400 [debug] [MainThread]: On master: Close
[0m23:10:10.694389 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:10:10.696393 [info ] [MainThread]: 
[0m23:10:10.703337 [debug] [Thread-1 (]: Began running node model.sakila_dbt.freezed_cand1
[0m23:10:10.705325 [info ] [Thread-1 (]: 1 of 1 START sql view model public.freezed_cand1 ............................... [RUN]
[0m23:10:10.707361 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sakila_dbt.freezed_cand1'
[0m23:10:10.709323 [debug] [Thread-1 (]: Began compiling node model.sakila_dbt.freezed_cand1
[0m23:10:10.717440 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakila_dbt.freezed_cand1"
[0m23:10:10.718440 [debug] [Thread-1 (]: Timing info for model.sakila_dbt.freezed_cand1 (compile): 23:10:10.710345 => 23:10:10.718440
[0m23:10:10.719443 [debug] [Thread-1 (]: Began executing node model.sakila_dbt.freezed_cand1
[0m23:10:10.757490 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakila_dbt.freezed_cand1"
[0m23:10:10.758501 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m23:10:10.758501 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: BEGIN
[0m23:10:10.759501 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:10:11.710859 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m23:10:11.712906 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m23:10:11.713907 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */

  create view "marketing"."public"."freezed_cand1__dbt_tmp"
    
    
  as (
    select *
from public.freezed_candidate_data a
limit 10
  );
[0m23:10:11.842486 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:10:11.853499 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m23:10:11.854499 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */
alter table "marketing"."public"."freezed_cand1" rename to "freezed_cand1__dbt_backup"
[0m23:10:11.973529 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:10:11.980509 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m23:10:11.980509 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */
alter table "marketing"."public"."freezed_cand1__dbt_tmp" rename to "freezed_cand1"
[0m23:10:12.100040 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:10:12.120611 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: COMMIT
[0m23:10:12.121598 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m23:10:12.121598 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: COMMIT
[0m23:10:12.241236 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:10:12.250208 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m23:10:12.251204 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */
drop view if exists "marketing"."public"."freezed_cand1__dbt_backup" cascade
[0m23:10:12.371496 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:10:12.375490 [debug] [Thread-1 (]: Timing info for model.sakila_dbt.freezed_cand1 (execute): 23:10:10.720443 => 23:10:12.375490
[0m23:10:12.377489 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: Close
[0m23:10:12.380154 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf90d14d-2c9c-433b-82d2-ce8e329bda4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C560D9BA0>]}
[0m23:10:12.381196 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.freezed_cand1 .......................... [[32mCREATE VIEW[0m in 1.67s]
[0m23:10:12.382223 [debug] [Thread-1 (]: Finished running node model.sakila_dbt.freezed_cand1
[0m23:10:12.385216 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:12.385216 [debug] [MainThread]: On master: BEGIN
[0m23:10:12.386651 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:10:13.470046 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m23:10:13.471105 [debug] [MainThread]: On master: COMMIT
[0m23:10:13.473046 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:13.474039 [debug] [MainThread]: On master: COMMIT
[0m23:10:13.595963 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:10:13.595963 [debug] [MainThread]: On master: Close
[0m23:10:13.596963 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:10:13.598261 [debug] [MainThread]: Connection 'list_marketing' was properly closed.
[0m23:10:13.599115 [debug] [MainThread]: Connection 'list_marketing_public' was properly closed.
[0m23:10:13.599115 [debug] [MainThread]: Connection 'model.sakila_dbt.freezed_cand1' was properly closed.
[0m23:10:13.599115 [info ] [MainThread]: 
[0m23:10:13.600129 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.84 seconds (6.84s).
[0m23:10:13.601129 [debug] [MainThread]: Command end result
[0m23:10:13.608108 [info ] [MainThread]: 
[0m23:10:13.609105 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:10:13.609105 [info ] [MainThread]: 
[0m23:10:13.609105 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:10:13.610549 [debug] [MainThread]: Command `dbt run` succeeded at 23:10:13.610549 after 7.08 seconds
[0m23:10:13.611550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C52F12BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C560876D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018C5356EA40>]}
[0m23:10:13.611550 [debug] [MainThread]: Flushing usage events
[0m23:12:30.663268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230FC642B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230FF38AAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230FF38A890>]}


============================== 23:12:30.666753 | 4c49a860-0899-4223-80c8-d2057b836944 ==============================
[0m23:12:30.666753 [info ] [MainThread]: Running with dbt=1.6.0
[0m23:12:30.667737 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\as4ti\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\as4ti\\OneDrive\\PowerBI\\Projects\\AgileEnginePBI\\Git_hub\\sakila_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:12:30.758233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c49a860-0899-4223-80c8-d2057b836944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230F863CBE0>]}
[0m23:12:30.766238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c49a860-0899-4223-80c8-d2057b836944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230FF4C4D60>]}
[0m23:12:30.767237 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m23:12:30.775221 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m23:12:30.781194 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:12:30.782151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4c49a860-0899-4223-80c8-d2057b836944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230FF4C7850>]}
[0m23:12:31.374710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c49a860-0899-4223-80c8-d2057b836944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230FF38A6E0>]}
[0m23:12:31.384051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c49a860-0899-4223-80c8-d2057b836944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230FF66FF70>]}
[0m23:12:31.385113 [info ] [MainThread]: Found 1 model, 2 tests, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m23:12:31.386114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c49a860-0899-4223-80c8-d2057b836944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230FF66E0B0>]}
[0m23:12:31.388368 [info ] [MainThread]: 
[0m23:12:31.390361 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:12:31.391360 [debug] [ThreadPool]: Acquiring new postgres connection 'list_marketing'
[0m23:12:31.403285 [debug] [ThreadPool]: Using postgres connection "list_marketing"
[0m23:12:31.404281 [debug] [ThreadPool]: On list_marketing: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "list_marketing"} */

    select distinct nspname from pg_namespace
  
[0m23:12:31.404281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:32.512102 [debug] [ThreadPool]: SQL status: SELECT 9 in 1.0 seconds
[0m23:12:32.515100 [debug] [ThreadPool]: On list_marketing: Close
[0m23:12:32.518035 [debug] [ThreadPool]: Acquiring new postgres connection 'list_marketing_public'
[0m23:12:32.524526 [debug] [ThreadPool]: Using postgres connection "list_marketing_public"
[0m23:12:32.524526 [debug] [ThreadPool]: On list_marketing_public: BEGIN
[0m23:12:32.525531 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:12:33.511756 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m23:12:33.512752 [debug] [ThreadPool]: Using postgres connection "list_marketing_public"
[0m23:12:33.512752 [debug] [ThreadPool]: On list_marketing_public: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "list_marketing_public"} */
select
      'marketing' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'marketing' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'marketing' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:12:33.637301 [debug] [ThreadPool]: SQL status: SELECT 77 in 0.0 seconds
[0m23:12:33.640293 [debug] [ThreadPool]: On list_marketing_public: ROLLBACK
[0m23:12:33.759600 [debug] [ThreadPool]: On list_marketing_public: Close
[0m23:12:33.773103 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:33.774105 [debug] [MainThread]: On master: BEGIN
[0m23:12:33.774105 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:12:34.751146 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m23:12:34.752189 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:34.754143 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:12:34.882304 [debug] [MainThread]: SQL status: SELECT 30 in 0.0 seconds
[0m23:12:34.887240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c49a860-0899-4223-80c8-d2057b836944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230FF5D9090>]}
[0m23:12:34.888219 [debug] [MainThread]: On master: ROLLBACK
[0m23:12:35.005056 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:35.006467 [debug] [MainThread]: On master: BEGIN
[0m23:12:35.243100 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:12:35.244152 [debug] [MainThread]: On master: COMMIT
[0m23:12:35.246143 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:35.247149 [debug] [MainThread]: On master: COMMIT
[0m23:12:35.365036 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:12:35.365961 [debug] [MainThread]: On master: Close
[0m23:12:35.367994 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:12:35.369007 [info ] [MainThread]: 
[0m23:12:35.373930 [debug] [Thread-1 (]: Began running node model.sakila_dbt.freezed_cand1
[0m23:12:35.374970 [info ] [Thread-1 (]: 1 of 1 START sql table model public.freezed_cand1 .............................. [RUN]
[0m23:12:35.375721 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sakila_dbt.freezed_cand1'
[0m23:12:35.377071 [debug] [Thread-1 (]: Began compiling node model.sakila_dbt.freezed_cand1
[0m23:12:35.385048 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakila_dbt.freezed_cand1"
[0m23:12:35.386045 [debug] [Thread-1 (]: Timing info for model.sakila_dbt.freezed_cand1 (compile): 23:12:35.378073 => 23:12:35.385048
[0m23:12:35.386045 [debug] [Thread-1 (]: Began executing node model.sakila_dbt.freezed_cand1
[0m23:12:35.428831 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakila_dbt.freezed_cand1"
[0m23:12:35.430315 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m23:12:35.430315 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: BEGIN
[0m23:12:35.431413 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:12:36.416034 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m23:12:36.418076 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m23:12:36.419096 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */

  
    

  create  table "marketing"."public"."freezed_cand1__dbt_tmp"
  
  
    as
  
  (
    select *
from public.freezed_candidate_data a
limit 10
  );
  
[0m23:12:36.562620 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m23:12:36.574618 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m23:12:36.574618 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */
alter table "marketing"."public"."freezed_cand1__dbt_tmp" rename to "freezed_cand1"
[0m23:12:36.696203 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:12:36.713151 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: COMMIT
[0m23:12:36.714148 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m23:12:36.714148 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: COMMIT
[0m23:12:36.835531 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:12:36.843546 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m23:12:36.844545 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */
drop table if exists "marketing"."public"."freezed_cand1__dbt_backup" cascade
[0m23:12:36.965492 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:12:36.969479 [debug] [Thread-1 (]: Timing info for model.sakila_dbt.freezed_cand1 (execute): 23:12:35.387041 => 23:12:36.969479
[0m23:12:36.971473 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: Close
[0m23:12:36.973503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c49a860-0899-4223-80c8-d2057b836944', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230FF574100>]}
[0m23:12:36.974507 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.freezed_cand1 ......................... [[32mSELECT 10[0m in 1.60s]
[0m23:12:36.976462 [debug] [Thread-1 (]: Finished running node model.sakila_dbt.freezed_cand1
[0m23:12:36.978631 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:36.978631 [debug] [MainThread]: On master: BEGIN
[0m23:12:36.978631 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:12:37.979396 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m23:12:37.980437 [debug] [MainThread]: On master: COMMIT
[0m23:12:37.982397 [debug] [MainThread]: Using postgres connection "master"
[0m23:12:37.982397 [debug] [MainThread]: On master: COMMIT
[0m23:12:38.101201 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:12:38.102867 [debug] [MainThread]: On master: Close
[0m23:12:38.104846 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:12:38.105836 [debug] [MainThread]: Connection 'list_marketing' was properly closed.
[0m23:12:38.106792 [debug] [MainThread]: Connection 'list_marketing_public' was properly closed.
[0m23:12:38.107788 [debug] [MainThread]: Connection 'model.sakila_dbt.freezed_cand1' was properly closed.
[0m23:12:38.109469 [info ] [MainThread]: 
[0m23:12:38.111476 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.72 seconds (6.72s).
[0m23:12:38.113469 [debug] [MainThread]: Command end result
[0m23:12:38.122438 [info ] [MainThread]: 
[0m23:12:38.123434 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:12:38.124474 [info ] [MainThread]: 
[0m23:12:38.125469 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:12:38.125469 [debug] [MainThread]: Command `dbt run` succeeded at 23:12:38.125469 after 7.48 seconds
[0m23:12:38.126477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230FC642B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230FF7507C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230FF696B30>]}
[0m23:12:38.127497 [debug] [MainThread]: Flushing usage events
[0m23:13:33.445436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BD5F92B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BD8CDAB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BD8CDA860>]}


============================== 23:13:33.449054 | 495c4265-f46c-43f0-8c5c-380d84fc5a7c ==============================
[0m23:13:33.449054 [info ] [MainThread]: Running with dbt=1.6.0
[0m23:13:33.450090 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\as4ti\\.dbt', 'log_path': 'C:\\Users\\as4ti\\OneDrive\\PowerBI\\Projects\\AgileEnginePBI\\Git_hub\\sakila_dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:13:33.538338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '495c4265-f46c-43f0-8c5c-380d84fc5a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BD1F8CBE0>]}
[0m23:13:33.545313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '495c4265-f46c-43f0-8c5c-380d84fc5a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BD8E14D90>]}
[0m23:13:33.547261 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m23:13:33.554283 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m23:13:33.560264 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:13:33.561220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '495c4265-f46c-43f0-8c5c-380d84fc5a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BD8E174C0>]}
[0m23:13:34.159016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '495c4265-f46c-43f0-8c5c-380d84fc5a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BD8F089A0>]}
[0m23:13:34.167488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '495c4265-f46c-43f0-8c5c-380d84fc5a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BD8FC8940>]}
[0m23:13:34.169483 [info ] [MainThread]: Found 1 model, 2 tests, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m23:13:34.170487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '495c4265-f46c-43f0-8c5c-380d84fc5a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BD8FC8880>]}
[0m23:13:34.172513 [info ] [MainThread]: 
[0m23:13:34.173331 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:13:34.175760 [debug] [ThreadPool]: Acquiring new postgres connection 'list_marketing'
[0m23:13:34.184234 [debug] [ThreadPool]: Using postgres connection "list_marketing"
[0m23:13:34.185231 [debug] [ThreadPool]: On list_marketing: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "list_marketing"} */

    select distinct nspname from pg_namespace
  
[0m23:13:34.185231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:13:35.207320 [debug] [ThreadPool]: SQL status: SELECT 9 in 1.0 seconds
[0m23:13:35.210331 [debug] [ThreadPool]: On list_marketing: Close
[0m23:13:35.214319 [debug] [ThreadPool]: Acquiring new postgres connection 'list_marketing_public'
[0m23:13:35.227273 [debug] [ThreadPool]: Using postgres connection "list_marketing_public"
[0m23:13:35.228270 [debug] [ThreadPool]: On list_marketing_public: BEGIN
[0m23:13:35.228270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:13:36.182711 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m23:13:36.183757 [debug] [ThreadPool]: Using postgres connection "list_marketing_public"
[0m23:13:36.185708 [debug] [ThreadPool]: On list_marketing_public: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "list_marketing_public"} */
select
      'marketing' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'marketing' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'marketing' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:13:36.316355 [debug] [ThreadPool]: SQL status: SELECT 78 in 0.0 seconds
[0m23:13:36.319346 [debug] [ThreadPool]: On list_marketing_public: ROLLBACK
[0m23:13:36.436729 [debug] [ThreadPool]: On list_marketing_public: Close
[0m23:13:36.451743 [debug] [MainThread]: Using postgres connection "master"
[0m23:13:36.451743 [debug] [MainThread]: On master: BEGIN
[0m23:13:36.452706 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:13:37.424885 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m23:13:37.425931 [debug] [MainThread]: Using postgres connection "master"
[0m23:13:37.427900 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:13:37.556358 [debug] [MainThread]: SQL status: SELECT 30 in 0.0 seconds
[0m23:13:37.560335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '495c4265-f46c-43f0-8c5c-380d84fc5a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BD8E82470>]}
[0m23:13:37.561328 [debug] [MainThread]: On master: ROLLBACK
[0m23:13:37.679194 [debug] [MainThread]: Using postgres connection "master"
[0m23:13:37.680239 [debug] [MainThread]: On master: BEGIN
[0m23:13:37.916389 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:13:37.917449 [debug] [MainThread]: On master: COMMIT
[0m23:13:37.919397 [debug] [MainThread]: Using postgres connection "master"
[0m23:13:37.920399 [debug] [MainThread]: On master: COMMIT
[0m23:13:38.039938 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:13:38.040984 [debug] [MainThread]: On master: Close
[0m23:13:38.042941 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:13:38.044965 [info ] [MainThread]: 
[0m23:13:38.051710 [debug] [Thread-1 (]: Began running node model.sakila_dbt.freezed_cand1
[0m23:13:38.052752 [info ] [Thread-1 (]: 1 of 1 START sql view model public.freezed_cand1 ............................... [RUN]
[0m23:13:38.055706 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sakila_dbt.freezed_cand1'
[0m23:13:38.056698 [debug] [Thread-1 (]: Began compiling node model.sakila_dbt.freezed_cand1
[0m23:13:38.064739 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakila_dbt.freezed_cand1"
[0m23:13:38.066291 [debug] [Thread-1 (]: Timing info for model.sakila_dbt.freezed_cand1 (compile): 23:13:38.057737 => 23:13:38.066291
[0m23:13:38.067291 [debug] [Thread-1 (]: Began executing node model.sakila_dbt.freezed_cand1
[0m23:13:38.098424 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakila_dbt.freezed_cand1"
[0m23:13:38.099418 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m23:13:38.099418 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: BEGIN
[0m23:13:38.100415 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:13:39.072369 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m23:13:39.074419 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m23:13:39.075419 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */

  create view "marketing"."public"."freezed_cand1__dbt_tmp"
    
    
  as (
    select *
from public.freezed_candidate_data a
limit 10
  );
[0m23:13:39.214544 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:13:39.226566 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m23:13:39.227557 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */
alter table "marketing"."public"."freezed_cand1" rename to "freezed_cand1__dbt_backup"
[0m23:13:39.348140 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:13:39.350981 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m23:13:39.351979 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */
alter table "marketing"."public"."freezed_cand1__dbt_tmp" rename to "freezed_cand1"
[0m23:13:39.473587 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:13:39.492528 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: COMMIT
[0m23:13:39.492528 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m23:13:39.493531 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: COMMIT
[0m23:13:39.615074 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:13:39.629081 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m23:13:39.630031 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */
drop table if exists "marketing"."public"."freezed_cand1__dbt_backup" cascade
[0m23:13:39.753450 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m23:13:39.757535 [debug] [Thread-1 (]: Timing info for model.sakila_dbt.freezed_cand1 (execute): 23:13:38.067291 => 23:13:39.756553
[0m23:13:39.758492 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: Close
[0m23:13:39.759520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '495c4265-f46c-43f0-8c5c-380d84fc5a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BD90B1C90>]}
[0m23:13:39.760522 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.freezed_cand1 .......................... [[32mCREATE VIEW[0m in 1.70s]
[0m23:13:39.761480 [debug] [Thread-1 (]: Finished running node model.sakila_dbt.freezed_cand1
[0m23:13:39.763473 [debug] [MainThread]: Using postgres connection "master"
[0m23:13:39.763473 [debug] [MainThread]: On master: BEGIN
[0m23:13:39.764513 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:13:40.836007 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m23:13:40.837918 [debug] [MainThread]: On master: COMMIT
[0m23:13:40.838914 [debug] [MainThread]: Using postgres connection "master"
[0m23:13:40.839956 [debug] [MainThread]: On master: COMMIT
[0m23:13:40.961412 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:13:40.962465 [debug] [MainThread]: On master: Close
[0m23:13:40.965415 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:13:40.967407 [debug] [MainThread]: Connection 'list_marketing' was properly closed.
[0m23:13:40.968404 [debug] [MainThread]: Connection 'list_marketing_public' was properly closed.
[0m23:13:40.969400 [debug] [MainThread]: Connection 'model.sakila_dbt.freezed_cand1' was properly closed.
[0m23:13:40.970397 [info ] [MainThread]: 
[0m23:13:40.971906 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.80 seconds (6.80s).
[0m23:13:40.972902 [debug] [MainThread]: Command end result
[0m23:13:40.980876 [info ] [MainThread]: 
[0m23:13:40.981875 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:13:40.982870 [info ] [MainThread]: 
[0m23:13:40.982870 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:13:40.983866 [debug] [MainThread]: Command `dbt run` succeeded at 23:13:40.983866 after 7.55 seconds
[0m23:13:40.983866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BD5F92B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BD9058A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BD8FE6FE0>]}
[0m23:13:40.985087 [debug] [MainThread]: Flushing usage events
[0m23:16:47.840497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F872892B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8755DAAA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8755DA860>]}


============================== 23:16:47.844497 | d0fcdcb8-46f5-4227-87c0-8ed0ab6db618 ==============================
[0m23:16:47.844497 [info ] [MainThread]: Running with dbt=1.6.0
[0m23:16:47.846483 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\as4ti\\OneDrive\\PowerBI\\Projects\\AgileEnginePBI\\Git_hub\\sakila_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\as4ti\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:16:47.932958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0fcdcb8-46f5-4227-87c0-8ed0ab6db618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F86E8ACBE0>]}
[0m23:16:47.940917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0fcdcb8-46f5-4227-87c0-8ed0ab6db618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F875710CD0>]}
[0m23:16:47.941928 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m23:16:47.948933 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m23:16:47.992648 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:16:47.992648 [debug] [MainThread]: Partial parsing: updated file: sakila_dbt://models\test_dbt1\freezed_cand1.sql
[0m23:16:48.045064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0fcdcb8-46f5-4227-87c0-8ed0ab6db618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8759715D0>]}
[0m23:16:48.053251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0fcdcb8-46f5-4227-87c0-8ed0ab6db618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F875858D60>]}
[0m23:16:48.053251 [info ] [MainThread]: Found 1 model, 2 tests, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m23:16:48.054377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0fcdcb8-46f5-4227-87c0-8ed0ab6db618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F87585BB50>]}
[0m23:16:48.055498 [info ] [MainThread]: 
[0m23:16:48.057514 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:16:48.059849 [debug] [ThreadPool]: Acquiring new postgres connection 'list_marketing'
[0m23:16:48.069109 [debug] [ThreadPool]: Using postgres connection "list_marketing"
[0m23:16:48.070147 [debug] [ThreadPool]: On list_marketing: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "list_marketing"} */

    select distinct nspname from pg_namespace
  
[0m23:16:48.070147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:16:49.525927 [debug] [ThreadPool]: SQL status: SELECT 9 in 1.0 seconds
[0m23:16:49.529062 [debug] [ThreadPool]: On list_marketing: Close
[0m23:16:49.532297 [debug] [ThreadPool]: Acquiring new postgres connection 'list_marketing_public'
[0m23:16:49.542000 [debug] [ThreadPool]: Using postgres connection "list_marketing_public"
[0m23:16:49.543083 [debug] [ThreadPool]: On list_marketing_public: BEGIN
[0m23:16:49.543083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:16:50.619426 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m23:16:50.621459 [debug] [ThreadPool]: Using postgres connection "list_marketing_public"
[0m23:16:50.622423 [debug] [ThreadPool]: On list_marketing_public: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "list_marketing_public"} */
select
      'marketing' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'marketing' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'marketing' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:16:50.747034 [debug] [ThreadPool]: SQL status: SELECT 78 in 0.0 seconds
[0m23:16:50.751041 [debug] [ThreadPool]: On list_marketing_public: ROLLBACK
[0m23:16:50.869645 [debug] [ThreadPool]: On list_marketing_public: Close
[0m23:16:50.887628 [debug] [MainThread]: Using postgres connection "master"
[0m23:16:50.887628 [debug] [MainThread]: On master: BEGIN
[0m23:16:50.888610 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:16:51.841381 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m23:16:51.842401 [debug] [MainThread]: Using postgres connection "master"
[0m23:16:51.844392 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:16:51.973137 [debug] [MainThread]: SQL status: SELECT 31 in 0.0 seconds
[0m23:16:51.977133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0fcdcb8-46f5-4227-87c0-8ed0ab6db618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8759AA7D0>]}
[0m23:16:51.978125 [debug] [MainThread]: On master: ROLLBACK
[0m23:16:52.095646 [debug] [MainThread]: Using postgres connection "master"
[0m23:16:52.096649 [debug] [MainThread]: On master: BEGIN
[0m23:16:52.332732 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:16:52.333764 [debug] [MainThread]: On master: COMMIT
[0m23:16:52.334759 [debug] [MainThread]: Using postgres connection "master"
[0m23:16:52.336712 [debug] [MainThread]: On master: COMMIT
[0m23:16:52.456681 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:16:52.457729 [debug] [MainThread]: On master: Close
[0m23:16:52.459701 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:16:52.461014 [info ] [MainThread]: 
[0m23:16:52.465078 [debug] [Thread-1 (]: Began running node model.sakila_dbt.freezed_cand1
[0m23:16:52.466078 [info ] [Thread-1 (]: 1 of 1 START sql view model public.freezed_cand1 ............................... [RUN]
[0m23:16:52.467436 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sakila_dbt.freezed_cand1'
[0m23:16:52.467436 [debug] [Thread-1 (]: Began compiling node model.sakila_dbt.freezed_cand1
[0m23:16:52.475465 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakila_dbt.freezed_cand1"
[0m23:16:52.476465 [debug] [Thread-1 (]: Timing info for model.sakila_dbt.freezed_cand1 (compile): 23:16:52.468462 => 23:16:52.476465
[0m23:16:52.477401 [debug] [Thread-1 (]: Began executing node model.sakila_dbt.freezed_cand1
[0m23:16:52.508335 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakila_dbt.freezed_cand1"
[0m23:16:52.509315 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m23:16:52.509315 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: BEGIN
[0m23:16:52.510290 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:16:53.492372 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m23:16:53.494415 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m23:16:53.495424 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */

  create view "marketing"."public"."freezed_cand1__dbt_tmp"
    
    
  as (
    select *
from public.freezed_candidate_data a
limit 5
  );
[0m23:16:53.622160 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:16:53.630078 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m23:16:53.631076 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */
alter table "marketing"."public"."freezed_cand1" rename to "freezed_cand1__dbt_backup"
[0m23:16:53.750032 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:16:53.758347 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m23:16:53.758347 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */
alter table "marketing"."public"."freezed_cand1__dbt_tmp" rename to "freezed_cand1"
[0m23:16:53.877760 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:16:53.899692 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: COMMIT
[0m23:16:53.900689 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m23:16:53.901719 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: COMMIT
[0m23:16:54.020279 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:16:54.028215 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m23:16:54.029166 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */
drop view if exists "marketing"."public"."freezed_cand1__dbt_backup" cascade
[0m23:16:54.149856 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:16:54.152897 [debug] [Thread-1 (]: Timing info for model.sakila_dbt.freezed_cand1 (execute): 23:16:52.477401 => 23:16:54.152897
[0m23:16:54.153865 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: Close
[0m23:16:54.154871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0fcdcb8-46f5-4227-87c0-8ed0ab6db618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F875A59B10>]}
[0m23:16:54.155913 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.freezed_cand1 .......................... [[32mCREATE VIEW[0m in 1.69s]
[0m23:16:54.156875 [debug] [Thread-1 (]: Finished running node model.sakila_dbt.freezed_cand1
[0m23:16:54.158832 [debug] [MainThread]: Using postgres connection "master"
[0m23:16:54.158832 [debug] [MainThread]: On master: BEGIN
[0m23:16:54.159829 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:16:55.274706 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m23:16:55.274706 [debug] [MainThread]: On master: COMMIT
[0m23:16:55.275703 [debug] [MainThread]: Using postgres connection "master"
[0m23:16:55.276597 [debug] [MainThread]: On master: COMMIT
[0m23:16:55.395478 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:16:55.396615 [debug] [MainThread]: On master: Close
[0m23:16:55.399863 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:16:55.400908 [debug] [MainThread]: Connection 'list_marketing' was properly closed.
[0m23:16:55.401917 [debug] [MainThread]: Connection 'list_marketing_public' was properly closed.
[0m23:16:55.401917 [debug] [MainThread]: Connection 'model.sakila_dbt.freezed_cand1' was properly closed.
[0m23:16:55.404057 [info ] [MainThread]: 
[0m23:16:55.405715 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.35 seconds (7.35s).
[0m23:16:55.406783 [debug] [MainThread]: Command end result
[0m23:16:55.414739 [info ] [MainThread]: 
[0m23:16:55.415241 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:16:55.415241 [info ] [MainThread]: 
[0m23:16:55.416242 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:16:55.417239 [debug] [MainThread]: Command `dbt run` succeeded at 23:16:55.417239 after 7.59 seconds
[0m23:16:55.417239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F872892B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F875A03640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F87569BBB0>]}
[0m23:16:55.418457 [debug] [MainThread]: Flushing usage events
[0m23:24:18.498592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016855222BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016857F7AA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016857F7A7D0>]}


============================== 23:24:18.502698 | a5ec968d-0048-49dd-8371-1b8b2c4d7df9 ==============================
[0m23:24:18.502698 [info ] [MainThread]: Running with dbt=1.6.0
[0m23:24:18.503697 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\as4ti\\.dbt', 'log_path': 'C:\\Users\\as4ti\\OneDrive\\PowerBI\\Projects\\AgileEnginePBI\\Git_hub\\sakila_dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:24:18.503697 [info ] [MainThread]: dbt version: 1.6.0
[0m23:24:18.504694 [info ] [MainThread]: python version: 3.10.10
[0m23:24:18.505691 [info ] [MainThread]: python path: C:\Python310\python.exe
[0m23:24:18.506694 [info ] [MainThread]: os info: Windows-10-10.0.22621-SP0
[0m23:24:18.552173 [info ] [MainThread]: Using profiles dir at C:\Users\as4ti\.dbt
[0m23:24:18.553189 [info ] [MainThread]: Using profiles.yml file at C:\Users\as4ti\.dbt\profiles.yml
[0m23:24:18.554133 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\as4ti\OneDrive\PowerBI\Projects\AgileEnginePBI\Git_hub\sakila_dbt\dbt_project.yml
[0m23:24:18.555129 [info ] [MainThread]: adapter type: postgres
[0m23:24:18.556126 [info ] [MainThread]: adapter version: 1.6.0
[0m23:24:18.573069 [info ] [MainThread]: Configuration:
[0m23:24:18.574066 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m23:24:18.575061 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:24:18.576059 [info ] [MainThread]: Required dependencies:
[0m23:24:18.576059 [debug] [MainThread]: Executing "git --help"
[0m23:24:18.593966 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:24:18.594970 [debug] [MainThread]: STDERR: "b''"
[0m23:24:18.594970 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:24:18.595959 [info ] [MainThread]: Connection:
[0m23:24:18.596958 [info ] [MainThread]:   host: dwh-analytics-marketing-replica.cm6kwlye3yy3.us-east-1.rds.amazonaws.com
[0m23:24:18.596958 [info ] [MainThread]:   port: 5432
[0m23:24:18.597954 [info ] [MainThread]:   user: illia_sterlihov
[0m23:24:18.597954 [info ] [MainThread]:   database: marketing
[0m23:24:18.598951 [info ] [MainThread]:   schema: public
[0m23:24:18.599947 [info ] [MainThread]:   connect_timeout: 5
[0m23:24:18.599947 [info ] [MainThread]:   role: None
[0m23:24:18.600943 [info ] [MainThread]:   search_path: None
[0m23:24:18.601975 [info ] [MainThread]:   keepalives_idle: 0
[0m23:24:18.602975 [info ] [MainThread]:   sslmode: None
[0m23:24:18.602975 [info ] [MainThread]:   sslcert: None
[0m23:24:18.603973 [info ] [MainThread]:   sslkey: None
[0m23:24:18.604968 [info ] [MainThread]:   sslrootcert: None
[0m23:24:18.604968 [info ] [MainThread]:   application_name: dbt
[0m23:24:18.605964 [info ] [MainThread]:   retries: 1
[0m23:24:18.606961 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m23:24:18.606961 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m23:24:18.607958 [debug] [MainThread]: Using postgres connection "debug"
[0m23:24:18.607958 [debug] [MainThread]: On debug: select 1 as id
[0m23:24:18.608955 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:24:19.696452 [debug] [MainThread]: SQL status: SELECT 1 in 1.0 seconds
[0m23:24:19.698446 [debug] [MainThread]: On debug: Close
[0m23:24:19.699685 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m23:24:19.699685 [info ] [MainThread]: [32mAll checks passed![0m
[0m23:24:19.700773 [debug] [MainThread]: Command `dbt debug` succeeded at 23:24:19.700773 after 1.21 seconds
[0m23:24:19.702040 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m23:24:19.702040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016855222BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001685587E8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016858085F90>]}
[0m23:24:19.703036 [debug] [MainThread]: Flushing usage events
[0m23:24:33.637885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F88A02B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F8B74AAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F8B74A890>]}


============================== 23:24:33.641885 | 923da060-25e0-4c5d-98e1-0bae0a87a51a ==============================
[0m23:24:33.641885 [info ] [MainThread]: Running with dbt=1.6.0
[0m23:24:33.642882 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\as4ti\\OneDrive\\PowerBI\\Projects\\AgileEnginePBI\\Git_hub\\sakila_dbt\\logs', 'profiles_dir': 'C:\\Users\\as4ti\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:24:33.728990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '923da060-25e0-4c5d-98e1-0bae0a87a51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F84ABCBE0>]}
[0m23:24:33.735474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '923da060-25e0-4c5d-98e1-0bae0a87a51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F8B888EE0>]}
[0m23:24:33.737740 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m23:24:33.744099 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m23:24:33.783899 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:24:33.784993 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:24:33.791203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '923da060-25e0-4c5d-98e1-0bae0a87a51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F8B9F80D0>]}
[0m23:24:33.800175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '923da060-25e0-4c5d-98e1-0bae0a87a51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F8B9CBA00>]}
[0m23:24:33.801509 [info ] [MainThread]: Found 1 model, 2 tests, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m23:24:33.802509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '923da060-25e0-4c5d-98e1-0bae0a87a51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F8B9CBB20>]}
[0m23:24:33.804501 [info ] [MainThread]: 
[0m23:24:33.805546 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:24:33.806497 [debug] [ThreadPool]: Acquiring new postgres connection 'list_marketing_public'
[0m23:24:33.816655 [debug] [ThreadPool]: Using postgres connection "list_marketing_public"
[0m23:24:33.817651 [debug] [ThreadPool]: On list_marketing_public: BEGIN
[0m23:24:33.817651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:24:34.897695 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m23:24:34.899746 [debug] [ThreadPool]: Using postgres connection "list_marketing_public"
[0m23:24:34.900693 [debug] [ThreadPool]: On list_marketing_public: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "list_marketing_public"} */
select
      'marketing' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'marketing' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'marketing' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:24:35.026282 [debug] [ThreadPool]: SQL status: SELECT 77 in 0.0 seconds
[0m23:24:35.028311 [debug] [ThreadPool]: On list_marketing_public: ROLLBACK
[0m23:24:35.149489 [debug] [ThreadPool]: On list_marketing_public: Close
[0m23:24:35.165240 [debug] [MainThread]: Using postgres connection "master"
[0m23:24:35.165240 [debug] [MainThread]: On master: BEGIN
[0m23:24:35.166237 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:24:36.144207 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m23:24:36.145268 [debug] [MainThread]: Using postgres connection "master"
[0m23:24:36.147248 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:24:36.275770 [debug] [MainThread]: SQL status: SELECT 30 in 0.0 seconds
[0m23:24:36.277767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '923da060-25e0-4c5d-98e1-0bae0a87a51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F8B9CAB30>]}
[0m23:24:36.277767 [debug] [MainThread]: On master: ROLLBACK
[0m23:24:36.396885 [debug] [MainThread]: Using postgres connection "master"
[0m23:24:36.396885 [debug] [MainThread]: On master: BEGIN
[0m23:24:36.633145 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:24:36.634196 [debug] [MainThread]: On master: COMMIT
[0m23:24:36.636142 [debug] [MainThread]: Using postgres connection "master"
[0m23:24:36.637138 [debug] [MainThread]: On master: COMMIT
[0m23:24:36.756454 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:24:36.756454 [debug] [MainThread]: On master: Close
[0m23:24:36.757454 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:24:36.758484 [info ] [MainThread]: 
[0m23:24:36.762368 [debug] [Thread-1 (]: Began running node test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98
[0m23:24:36.762368 [info ] [Thread-1 (]: 1 of 2 START test not_null_freezed_cand1_id .................................... [RUN]
[0m23:24:36.763458 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98'
[0m23:24:36.764490 [debug] [Thread-1 (]: Began compiling node test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98
[0m23:24:36.778445 [debug] [Thread-1 (]: Writing injected SQL for node "test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98"
[0m23:24:36.780408 [debug] [Thread-1 (]: Timing info for test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98 (compile): 23:24:36.764490 => 23:24:36.779450
[0m23:24:36.780408 [debug] [Thread-1 (]: Began executing node test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98
[0m23:24:36.795890 [debug] [Thread-1 (]: Writing runtime sql for node "test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98"
[0m23:24:36.796886 [debug] [Thread-1 (]: Using postgres connection "test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98"
[0m23:24:36.797883 [debug] [Thread-1 (]: On test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98: BEGIN
[0m23:24:36.797883 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:24:37.756746 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m23:24:37.757743 [debug] [Thread-1 (]: Using postgres connection "test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98"
[0m23:24:37.759736 [debug] [Thread-1 (]: On test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "marketing"."public"."freezed_cand1"
where id is null



      
    ) dbt_internal_test
[0m23:24:37.886707 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.freezed_cand1" does not exist
LINE 14: from "marketing"."public"."freezed_cand1"
              ^

[0m23:24:37.887703 [debug] [Thread-1 (]: On test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98: ROLLBACK
[0m23:24:38.007855 [debug] [Thread-1 (]: Timing info for test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98 (execute): 23:24:36.780408 => 23:24:38.007206
[0m23:24:38.007855 [debug] [Thread-1 (]: On test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98: Close
[0m23:24:38.081612 [debug] [Thread-1 (]: Database Error in test not_null_freezed_cand1_id (models\test_dbt1\schema.yml)
  relation "public.freezed_cand1" does not exist
  LINE 14: from "marketing"."public"."freezed_cand1"
                ^
  compiled Code at target\run\sakila_dbt\models\test_dbt1\schema.yml\not_null_freezed_cand1_id.sql
[0m23:24:38.082609 [error] [Thread-1 (]: 1 of 2 ERROR not_null_freezed_cand1_id ......................................... [[31mERROR[0m in 1.32s]
[0m23:24:38.083603 [debug] [Thread-1 (]: Finished running node test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98
[0m23:24:38.083603 [debug] [Thread-1 (]: Began running node test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4
[0m23:24:38.084602 [info ] [Thread-1 (]: 2 of 2 START test unique_freezed_cand1_id ...................................... [RUN]
[0m23:24:38.085598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98, now test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4)
[0m23:24:38.086596 [debug] [Thread-1 (]: Began compiling node test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4
[0m23:24:38.091579 [debug] [Thread-1 (]: Writing injected SQL for node "test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4"
[0m23:24:38.092576 [debug] [Thread-1 (]: Timing info for test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4 (compile): 23:24:38.086596 => 23:24:38.092576
[0m23:24:38.093808 [debug] [Thread-1 (]: Began executing node test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4
[0m23:24:38.096314 [debug] [Thread-1 (]: Writing runtime sql for node "test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4"
[0m23:24:38.097310 [debug] [Thread-1 (]: Using postgres connection "test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4"
[0m23:24:38.097310 [debug] [Thread-1 (]: On test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4: BEGIN
[0m23:24:38.098305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:24:39.059841 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m23:24:39.061892 [debug] [Thread-1 (]: Using postgres connection "test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4"
[0m23:24:39.062888 [debug] [Thread-1 (]: On test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "marketing"."public"."freezed_cand1"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:24:39.181743 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.freezed_cand1" does not exist
LINE 15: from "marketing"."public"."freezed_cand1"
              ^

[0m23:24:39.182744 [debug] [Thread-1 (]: On test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4: ROLLBACK
[0m23:24:39.301035 [debug] [Thread-1 (]: Timing info for test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4 (execute): 23:24:38.093808 => 23:24:39.300421
[0m23:24:39.303034 [debug] [Thread-1 (]: On test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4: Close
[0m23:24:39.306023 [debug] [Thread-1 (]: Database Error in test unique_freezed_cand1_id (models\test_dbt1\schema.yml)
  relation "public.freezed_cand1" does not exist
  LINE 15: from "marketing"."public"."freezed_cand1"
                ^
  compiled Code at target\run\sakila_dbt\models\test_dbt1\schema.yml\unique_freezed_cand1_id.sql
[0m23:24:39.308017 [error] [Thread-1 (]: 2 of 2 ERROR unique_freezed_cand1_id ........................................... [[31mERROR[0m in 1.22s]
[0m23:24:39.310011 [debug] [Thread-1 (]: Finished running node test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4
[0m23:24:39.312005 [debug] [MainThread]: Using postgres connection "master"
[0m23:24:39.313043 [debug] [MainThread]: On master: BEGIN
[0m23:24:39.313043 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:24:40.368674 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m23:24:40.369650 [debug] [MainThread]: On master: COMMIT
[0m23:24:40.371602 [debug] [MainThread]: Using postgres connection "master"
[0m23:24:40.372636 [debug] [MainThread]: On master: COMMIT
[0m23:24:40.490964 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:24:40.491955 [debug] [MainThread]: On master: Close
[0m23:24:40.493946 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:24:40.494943 [debug] [MainThread]: Connection 'list_marketing_public' was properly closed.
[0m23:24:40.495939 [debug] [MainThread]: Connection 'test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4' was properly closed.
[0m23:24:40.495939 [info ] [MainThread]: 
[0m23:24:40.496936 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 6.69 seconds (6.69s).
[0m23:24:40.498928 [debug] [MainThread]: Command end result
[0m23:24:40.505928 [info ] [MainThread]: 
[0m23:24:40.506928 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m23:24:40.506928 [info ] [MainThread]: 
[0m23:24:40.507923 [error] [MainThread]: [33mDatabase Error in test not_null_freezed_cand1_id (models\test_dbt1\schema.yml)[0m
[0m23:24:40.509426 [error] [MainThread]:   relation "public.freezed_cand1" does not exist
[0m23:24:40.510107 [error] [MainThread]:   LINE 14: from "marketing"."public"."freezed_cand1"
[0m23:24:40.510107 [error] [MainThread]:                 ^
[0m23:24:40.511077 [error] [MainThread]:   compiled Code at target\run\sakila_dbt\models\test_dbt1\schema.yml\not_null_freezed_cand1_id.sql
[0m23:24:40.511077 [info ] [MainThread]: 
[0m23:24:40.512077 [error] [MainThread]: [33mDatabase Error in test unique_freezed_cand1_id (models\test_dbt1\schema.yml)[0m
[0m23:24:40.513112 [error] [MainThread]:   relation "public.freezed_cand1" does not exist
[0m23:24:40.513112 [error] [MainThread]:   LINE 15: from "marketing"."public"."freezed_cand1"
[0m23:24:40.514071 [error] [MainThread]:                 ^
[0m23:24:40.515066 [error] [MainThread]:   compiled Code at target\run\sakila_dbt\models\test_dbt1\schema.yml\unique_freezed_cand1_id.sql
[0m23:24:40.515066 [info ] [MainThread]: 
[0m23:24:40.516008 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m23:24:40.517054 [debug] [MainThread]: Command `dbt test` failed at 23:24:40.516008 after 6.89 seconds
[0m23:24:40.517054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F88A02B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F8B9C87C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F8B9CADA0>]}
[0m23:24:40.517054 [debug] [MainThread]: Flushing usage events
[0m23:47:57.143593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A82DB2BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A85AEABC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A85AEA980>]}


============================== 23:47:57.147585 | 03d99c3a-7137-40e3-8de8-9b2b78e6fb1e ==============================
[0m23:47:57.147585 [info ] [MainThread]: Running with dbt=1.6.0
[0m23:47:57.148652 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\as4ti\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\as4ti\\OneDrive\\PowerBI\\Projects\\AgileEnginePBI\\Git_hub\\sakila_dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test -m test_dbt1', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:47:57.276074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03d99c3a-7137-40e3-8de8-9b2b78e6fb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AFEDACC10>]}
[0m23:47:57.282858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03d99c3a-7137-40e3-8de8-9b2b78e6fb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A85C20E20>]}
[0m23:47:57.284919 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m23:47:57.302865 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m23:47:57.918524 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:47:57.919571 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:47:57.927363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03d99c3a-7137-40e3-8de8-9b2b78e6fb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A85D980D0>]}
[0m23:47:57.948063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03d99c3a-7137-40e3-8de8-9b2b78e6fb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A85D6BAC0>]}
[0m23:47:57.948927 [info ] [MainThread]: Found 1 model, 2 tests, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m23:47:57.949951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03d99c3a-7137-40e3-8de8-9b2b78e6fb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A85D6BBE0>]}
[0m23:47:57.950952 [info ] [MainThread]: 
[0m23:47:57.951950 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:47:57.952946 [debug] [ThreadPool]: Acquiring new postgres connection 'list_marketing_public'
[0m23:47:57.963491 [debug] [ThreadPool]: Using postgres connection "list_marketing_public"
[0m23:47:57.964450 [debug] [ThreadPool]: On list_marketing_public: BEGIN
[0m23:47:57.964450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:47:59.064669 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m23:47:59.065719 [debug] [ThreadPool]: Using postgres connection "list_marketing_public"
[0m23:47:59.066713 [debug] [ThreadPool]: On list_marketing_public: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "list_marketing_public"} */
select
      'marketing' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'marketing' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'marketing' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:47:59.189710 [debug] [ThreadPool]: SQL status: SELECT 77 in 0.0 seconds
[0m23:47:59.195750 [debug] [ThreadPool]: On list_marketing_public: ROLLBACK
[0m23:47:59.313891 [debug] [ThreadPool]: On list_marketing_public: Close
[0m23:47:59.329154 [debug] [MainThread]: Using postgres connection "master"
[0m23:47:59.330188 [debug] [MainThread]: On master: BEGIN
[0m23:47:59.330188 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:48:00.296578 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m23:48:00.296578 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:00.297806 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:48:00.426508 [debug] [MainThread]: SQL status: SELECT 30 in 0.0 seconds
[0m23:48:00.429008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03d99c3a-7137-40e3-8de8-9b2b78e6fb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A85D684C0>]}
[0m23:48:00.429008 [debug] [MainThread]: On master: ROLLBACK
[0m23:48:00.550876 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:00.550876 [debug] [MainThread]: On master: BEGIN
[0m23:48:00.817285 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:48:00.818791 [debug] [MainThread]: On master: COMMIT
[0m23:48:00.819791 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:00.820792 [debug] [MainThread]: On master: COMMIT
[0m23:48:00.943636 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:48:00.944632 [debug] [MainThread]: On master: Close
[0m23:48:00.946624 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:48:00.947651 [info ] [MainThread]: 
[0m23:48:00.950937 [debug] [Thread-1 (]: Began running node test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98
[0m23:48:00.952441 [info ] [Thread-1 (]: 1 of 2 START test not_null_freezed_cand1_id .................................... [RUN]
[0m23:48:00.954489 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98'
[0m23:48:00.956492 [debug] [Thread-1 (]: Began compiling node test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98
[0m23:48:00.975491 [debug] [Thread-1 (]: Writing injected SQL for node "test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98"
[0m23:48:00.976487 [debug] [Thread-1 (]: Timing info for test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98 (compile): 23:48:00.956492 => 23:48:00.976487
[0m23:48:00.977484 [debug] [Thread-1 (]: Began executing node test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98
[0m23:48:00.991429 [debug] [Thread-1 (]: Writing runtime sql for node "test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98"
[0m23:48:00.992434 [debug] [Thread-1 (]: Using postgres connection "test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98"
[0m23:48:00.993421 [debug] [Thread-1 (]: On test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98: BEGIN
[0m23:48:00.994418 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:48:01.978588 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m23:48:01.980096 [debug] [Thread-1 (]: Using postgres connection "test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98"
[0m23:48:01.981097 [debug] [Thread-1 (]: On test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "marketing"."public"."freezed_cand1"
where id is null



      
    ) dbt_internal_test
[0m23:48:02.103042 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.freezed_cand1" does not exist
LINE 14: from "marketing"."public"."freezed_cand1"
              ^

[0m23:48:02.103042 [debug] [Thread-1 (]: On test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98: ROLLBACK
[0m23:48:02.223999 [debug] [Thread-1 (]: Timing info for test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98 (execute): 23:48:00.977484 => 23:48:02.223398
[0m23:48:02.225001 [debug] [Thread-1 (]: On test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98: Close
[0m23:48:02.301934 [debug] [Thread-1 (]: Database Error in test not_null_freezed_cand1_id (models\test_dbt1\schema.yml)
  relation "public.freezed_cand1" does not exist
  LINE 14: from "marketing"."public"."freezed_cand1"
                ^
  compiled Code at target\run\sakila_dbt\models\test_dbt1\schema.yml\not_null_freezed_cand1_id.sql
[0m23:48:02.302967 [error] [Thread-1 (]: 1 of 2 ERROR not_null_freezed_cand1_id ......................................... [[31mERROR[0m in 1.35s]
[0m23:48:02.303973 [debug] [Thread-1 (]: Finished running node test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98
[0m23:48:02.304923 [debug] [Thread-1 (]: Began running node test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4
[0m23:48:02.305919 [info ] [Thread-1 (]: 2 of 2 START test unique_freezed_cand1_id ...................................... [RUN]
[0m23:48:02.306916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98, now test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4)
[0m23:48:02.306916 [debug] [Thread-1 (]: Began compiling node test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4
[0m23:48:02.314557 [debug] [Thread-1 (]: Writing injected SQL for node "test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4"
[0m23:48:02.315553 [debug] [Thread-1 (]: Timing info for test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4 (compile): 23:48:02.308419 => 23:48:02.315553
[0m23:48:02.316590 [debug] [Thread-1 (]: Began executing node test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4
[0m23:48:02.319048 [debug] [Thread-1 (]: Writing runtime sql for node "test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4"
[0m23:48:02.320048 [debug] [Thread-1 (]: Using postgres connection "test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4"
[0m23:48:02.321093 [debug] [Thread-1 (]: On test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4: BEGIN
[0m23:48:02.322082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:48:03.310829 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m23:48:03.311863 [debug] [Thread-1 (]: Using postgres connection "test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4"
[0m23:48:03.313818 [debug] [Thread-1 (]: On test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "marketing"."public"."freezed_cand1"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:48:03.432498 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.freezed_cand1" does not exist
LINE 15: from "marketing"."public"."freezed_cand1"
              ^

[0m23:48:03.433539 [debug] [Thread-1 (]: On test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4: ROLLBACK
[0m23:48:03.551836 [debug] [Thread-1 (]: Timing info for test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4 (execute): 23:48:02.316590 => 23:48:03.551836
[0m23:48:03.552340 [debug] [Thread-1 (]: On test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4: Close
[0m23:48:03.553340 [debug] [Thread-1 (]: Database Error in test unique_freezed_cand1_id (models\test_dbt1\schema.yml)
  relation "public.freezed_cand1" does not exist
  LINE 15: from "marketing"."public"."freezed_cand1"
                ^
  compiled Code at target\run\sakila_dbt\models\test_dbt1\schema.yml\unique_freezed_cand1_id.sql
[0m23:48:03.554914 [error] [Thread-1 (]: 2 of 2 ERROR unique_freezed_cand1_id ........................................... [[31mERROR[0m in 1.25s]
[0m23:48:03.554914 [debug] [Thread-1 (]: Finished running node test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4
[0m23:48:03.556912 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:03.558415 [debug] [MainThread]: On master: BEGIN
[0m23:48:03.559430 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:48:04.645094 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m23:48:04.646132 [debug] [MainThread]: On master: COMMIT
[0m23:48:04.647120 [debug] [MainThread]: Using postgres connection "master"
[0m23:48:04.649652 [debug] [MainThread]: On master: COMMIT
[0m23:48:04.769748 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:48:04.770740 [debug] [MainThread]: On master: Close
[0m23:48:04.771742 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:48:04.772692 [debug] [MainThread]: Connection 'list_marketing_public' was properly closed.
[0m23:48:04.772692 [debug] [MainThread]: Connection 'test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4' was properly closed.
[0m23:48:04.773688 [info ] [MainThread]: 
[0m23:48:04.773688 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 6.82 seconds (6.82s).
[0m23:48:04.775681 [debug] [MainThread]: Command end result
[0m23:48:04.782259 [info ] [MainThread]: 
[0m23:48:04.782259 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m23:48:04.783213 [info ] [MainThread]: 
[0m23:48:04.784208 [error] [MainThread]: [33mDatabase Error in test not_null_freezed_cand1_id (models\test_dbt1\schema.yml)[0m
[0m23:48:04.785553 [error] [MainThread]:   relation "public.freezed_cand1" does not exist
[0m23:48:04.786553 [error] [MainThread]:   LINE 14: from "marketing"."public"."freezed_cand1"
[0m23:48:04.786553 [error] [MainThread]:                 ^
[0m23:48:04.787551 [error] [MainThread]:   compiled Code at target\run\sakila_dbt\models\test_dbt1\schema.yml\not_null_freezed_cand1_id.sql
[0m23:48:04.788557 [info ] [MainThread]: 
[0m23:48:04.788557 [error] [MainThread]: [33mDatabase Error in test unique_freezed_cand1_id (models\test_dbt1\schema.yml)[0m
[0m23:48:04.789665 [error] [MainThread]:   relation "public.freezed_cand1" does not exist
[0m23:48:04.789665 [error] [MainThread]:   LINE 15: from "marketing"."public"."freezed_cand1"
[0m23:48:04.790921 [error] [MainThread]:                 ^
[0m23:48:04.790921 [error] [MainThread]:   compiled Code at target\run\sakila_dbt\models\test_dbt1\schema.yml\unique_freezed_cand1_id.sql
[0m23:48:04.791934 [info ] [MainThread]: 
[0m23:48:04.792924 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m23:48:04.792924 [debug] [MainThread]: Command `dbt test` failed at 23:48:04.792924 after 7.68 seconds
[0m23:48:04.793919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A82DB2BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A85D6B3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A85D6B070>]}
[0m23:48:04.793919 [debug] [MainThread]: Flushing usage events
[0m23:58:05.498278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C02A332B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C02D07EAA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C02D07E860>]}


============================== 23:58:05.501937 | bf592099-653a-42b1-b21e-3335c4d471c9 ==============================
[0m23:58:05.501937 [info ] [MainThread]: Running with dbt=1.6.0
[0m23:58:05.502930 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\as4ti\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\as4ti\\OneDrive\\PowerBI\\Projects\\AgileEnginePBI\\Git_hub\\sakila_dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:58:05.592123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf592099-653a-42b1-b21e-3335c4d471c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C02635CBE0>]}
[0m23:58:05.600865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf592099-653a-42b1-b21e-3335c4d471c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C02D1B4C70>]}
[0m23:58:05.602139 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m23:58:05.609684 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m23:58:05.648072 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:58:05.649074 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:58:05.654174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf592099-653a-42b1-b21e-3335c4d471c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C02D3280D0>]}
[0m23:58:05.662297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf592099-653a-42b1-b21e-3335c4d471c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C02D2FBA60>]}
[0m23:58:05.663293 [info ] [MainThread]: Found 1 model, 2 tests, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m23:58:05.664290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf592099-653a-42b1-b21e-3335c4d471c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C02D2FBA00>]}
[0m23:58:05.665364 [info ] [MainThread]: 
[0m23:58:05.666532 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:58:05.668983 [debug] [ThreadPool]: Acquiring new postgres connection 'list_marketing'
[0m23:58:05.680063 [debug] [ThreadPool]: Using postgres connection "list_marketing"
[0m23:58:05.681061 [debug] [ThreadPool]: On list_marketing: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "list_marketing"} */

    select distinct nspname from pg_namespace
  
[0m23:58:05.682057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:58:06.765785 [debug] [ThreadPool]: SQL status: SELECT 9 in 1.0 seconds
[0m23:58:06.767791 [debug] [ThreadPool]: On list_marketing: Close
[0m23:58:06.769887 [debug] [ThreadPool]: Acquiring new postgres connection 'list_marketing_public'
[0m23:58:06.774811 [debug] [ThreadPool]: Using postgres connection "list_marketing_public"
[0m23:58:06.775809 [debug] [ThreadPool]: On list_marketing_public: BEGIN
[0m23:58:06.775809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:58:07.729024 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m23:58:07.730069 [debug] [ThreadPool]: Using postgres connection "list_marketing_public"
[0m23:58:07.732028 [debug] [ThreadPool]: On list_marketing_public: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "list_marketing_public"} */
select
      'marketing' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'marketing' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'marketing' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:58:07.853466 [debug] [ThreadPool]: SQL status: SELECT 77 in 0.0 seconds
[0m23:58:07.857497 [debug] [ThreadPool]: On list_marketing_public: ROLLBACK
[0m23:58:07.976071 [debug] [ThreadPool]: On list_marketing_public: Close
[0m23:58:07.993588 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:07.993588 [debug] [MainThread]: On master: BEGIN
[0m23:58:07.994546 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:58:08.982884 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m23:58:08.984577 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:08.985617 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:58:09.118735 [debug] [MainThread]: SQL status: SELECT 30 in 0.0 seconds
[0m23:58:09.123485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf592099-653a-42b1-b21e-3335c4d471c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C02D375450>]}
[0m23:58:09.124482 [debug] [MainThread]: On master: ROLLBACK
[0m23:58:09.245896 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:09.246941 [debug] [MainThread]: On master: BEGIN
[0m23:58:09.557847 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:58:09.558883 [debug] [MainThread]: On master: COMMIT
[0m23:58:09.560841 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:09.561882 [debug] [MainThread]: On master: COMMIT
[0m23:58:09.680751 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:58:09.681754 [debug] [MainThread]: On master: Close
[0m23:58:09.683747 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:58:09.684745 [info ] [MainThread]: 
[0m23:58:09.689772 [debug] [Thread-1 (]: Began running node model.sakila_dbt.freezed_cand1
[0m23:58:09.690773 [info ] [Thread-1 (]: 1 of 1 START sql view model public.freezed_cand1 ............................... [RUN]
[0m23:58:09.692766 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.sakila_dbt.freezed_cand1'
[0m23:58:09.692766 [debug] [Thread-1 (]: Began compiling node model.sakila_dbt.freezed_cand1
[0m23:58:09.700738 [debug] [Thread-1 (]: Writing injected SQL for node "model.sakila_dbt.freezed_cand1"
[0m23:58:09.701736 [debug] [Thread-1 (]: Timing info for model.sakila_dbt.freezed_cand1 (compile): 23:58:09.693763 => 23:58:09.700738
[0m23:58:09.701736 [debug] [Thread-1 (]: Began executing node model.sakila_dbt.freezed_cand1
[0m23:58:09.738297 [debug] [Thread-1 (]: Writing runtime sql for node "model.sakila_dbt.freezed_cand1"
[0m23:58:09.739295 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m23:58:09.740291 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: BEGIN
[0m23:58:09.740291 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:58:10.699728 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m23:58:10.700713 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m23:58:10.702712 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */

  create view "marketing"."public"."freezed_cand1__dbt_tmp"
    
    
  as (
    select *
from public.freezed_candidate_data a
limit 5
  );
[0m23:58:10.831158 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m23:58:10.842133 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m23:58:10.843177 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */
alter table "marketing"."public"."freezed_cand1__dbt_tmp" rename to "freezed_cand1"
[0m23:58:10.962050 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m23:58:10.974516 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: COMMIT
[0m23:58:10.975513 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m23:58:10.975513 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: COMMIT
[0m23:58:11.095548 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m23:58:11.107734 [debug] [Thread-1 (]: Using postgres connection "model.sakila_dbt.freezed_cand1"
[0m23:58:11.108731 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "model.sakila_dbt.freezed_cand1"} */
drop view if exists "marketing"."public"."freezed_cand1__dbt_backup" cascade
[0m23:58:11.227120 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m23:58:11.231104 [debug] [Thread-1 (]: Timing info for model.sakila_dbt.freezed_cand1 (execute): 23:58:09.702732 => 23:58:11.230095
[0m23:58:11.233049 [debug] [Thread-1 (]: On model.sakila_dbt.freezed_cand1: Close
[0m23:58:11.235076 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf592099-653a-42b1-b21e-3335c4d471c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C02D1815A0>]}
[0m23:58:11.237078 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.freezed_cand1 .......................... [[32mCREATE VIEW[0m in 1.54s]
[0m23:58:11.239071 [debug] [Thread-1 (]: Finished running node model.sakila_dbt.freezed_cand1
[0m23:58:11.243014 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:11.243014 [debug] [MainThread]: On master: BEGIN
[0m23:58:11.244011 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:58:12.329627 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m23:58:12.330680 [debug] [MainThread]: On master: COMMIT
[0m23:58:12.332623 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:12.333622 [debug] [MainThread]: On master: COMMIT
[0m23:58:12.454260 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:58:12.454260 [debug] [MainThread]: On master: Close
[0m23:58:12.456257 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:58:12.457253 [debug] [MainThread]: Connection 'list_marketing' was properly closed.
[0m23:58:12.458250 [debug] [MainThread]: Connection 'list_marketing_public' was properly closed.
[0m23:58:12.458250 [debug] [MainThread]: Connection 'model.sakila_dbt.freezed_cand1' was properly closed.
[0m23:58:12.459246 [info ] [MainThread]: 
[0m23:58:12.460245 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.79 seconds (6.79s).
[0m23:58:12.462236 [debug] [MainThread]: Command end result
[0m23:58:12.469116 [info ] [MainThread]: 
[0m23:58:12.470114 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:58:12.470114 [info ] [MainThread]: 
[0m23:58:12.471107 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:58:12.472111 [debug] [MainThread]: Command `dbt run` succeeded at 23:58:12.472111 after 6.99 seconds
[0m23:58:12.472111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C02A332B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C02D1815A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C02D13B8B0>]}
[0m23:58:12.473102 [debug] [MainThread]: Flushing usage events
[0m23:58:22.357690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C7722B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4CA46AB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4CA46A860>]}


============================== 23:58:22.360714 | 27ff7ef9-3909-4833-9d21-6c3c8f77be85 ==============================
[0m23:58:22.360714 [info ] [MainThread]: Running with dbt=1.6.0
[0m23:58:22.361721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\as4ti\\.dbt', 'log_path': 'C:\\Users\\as4ti\\OneDrive\\PowerBI\\Projects\\AgileEnginePBI\\Git_hub\\sakila_dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test -m test_dbt1', 'send_anonymous_usage_stats': 'True'}
[0m23:58:22.449620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27ff7ef9-3909-4833-9d21-6c3c8f77be85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C371CC10>]}
[0m23:58:22.457058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27ff7ef9-3909-4833-9d21-6c3c8f77be85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4CA5ACD60>]}
[0m23:58:22.458556 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m23:58:22.464540 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m23:58:22.502334 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:58:22.502334 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:58:22.507902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27ff7ef9-3909-4833-9d21-6c3c8f77be85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4CA71C0D0>]}
[0m23:58:22.519544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27ff7ef9-3909-4833-9d21-6c3c8f77be85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4CA6EFA00>]}
[0m23:58:22.520541 [info ] [MainThread]: Found 1 model, 2 tests, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m23:58:22.520541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27ff7ef9-3909-4833-9d21-6c3c8f77be85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4CA6EFB20>]}
[0m23:58:22.523026 [info ] [MainThread]: 
[0m23:58:22.523026 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:58:22.525456 [debug] [ThreadPool]: Acquiring new postgres connection 'list_marketing_public'
[0m23:58:22.536821 [debug] [ThreadPool]: Using postgres connection "list_marketing_public"
[0m23:58:22.537974 [debug] [ThreadPool]: On list_marketing_public: BEGIN
[0m23:58:22.537974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:58:23.643661 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m23:58:23.644716 [debug] [ThreadPool]: Using postgres connection "list_marketing_public"
[0m23:58:23.646669 [debug] [ThreadPool]: On list_marketing_public: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "list_marketing_public"} */
select
      'marketing' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'marketing' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'marketing' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:58:23.774840 [debug] [ThreadPool]: SQL status: SELECT 78 in 0.0 seconds
[0m23:58:23.779830 [debug] [ThreadPool]: On list_marketing_public: ROLLBACK
[0m23:58:23.901247 [debug] [ThreadPool]: On list_marketing_public: Close
[0m23:58:23.916104 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:23.917100 [debug] [MainThread]: On master: BEGIN
[0m23:58:23.918100 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:58:24.892254 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m23:58:24.893242 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:24.895202 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:58:25.026697 [debug] [MainThread]: SQL status: SELECT 31 in 0.0 seconds
[0m23:58:25.031686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27ff7ef9-3909-4833-9d21-6c3c8f77be85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4CA6EC400>]}
[0m23:58:25.033477 [debug] [MainThread]: On master: ROLLBACK
[0m23:58:25.153817 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:25.155789 [debug] [MainThread]: On master: BEGIN
[0m23:58:25.396768 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:58:25.397771 [debug] [MainThread]: On master: COMMIT
[0m23:58:25.398767 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:25.399764 [debug] [MainThread]: On master: COMMIT
[0m23:58:25.521210 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:58:25.521210 [debug] [MainThread]: On master: Close
[0m23:58:25.522210 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:58:25.523206 [info ] [MainThread]: 
[0m23:58:25.527637 [debug] [Thread-1 (]: Began running node test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98
[0m23:58:25.527637 [info ] [Thread-1 (]: 1 of 2 START test not_null_freezed_cand1_id .................................... [RUN]
[0m23:58:25.528754 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98'
[0m23:58:25.530096 [debug] [Thread-1 (]: Began compiling node test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98
[0m23:58:25.544097 [debug] [Thread-1 (]: Writing injected SQL for node "test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98"
[0m23:58:25.545049 [debug] [Thread-1 (]: Timing info for test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98 (compile): 23:58:25.530096 => 23:58:25.545049
[0m23:58:25.545049 [debug] [Thread-1 (]: Began executing node test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98
[0m23:58:25.559052 [debug] [Thread-1 (]: Writing runtime sql for node "test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98"
[0m23:58:25.560051 [debug] [Thread-1 (]: Using postgres connection "test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98"
[0m23:58:25.561377 [debug] [Thread-1 (]: On test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98: BEGIN
[0m23:58:25.561377 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:58:26.521683 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m23:58:26.523723 [debug] [Thread-1 (]: Using postgres connection "test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98"
[0m23:58:26.524681 [debug] [Thread-1 (]: On test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "marketing"."public"."freezed_cand1"
where id is null



      
    ) dbt_internal_test
[0m23:58:26.646667 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:58:26.649640 [debug] [Thread-1 (]: Timing info for test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98 (execute): 23:58:25.546045 => 23:58:26.649640
[0m23:58:26.651602 [debug] [Thread-1 (]: On test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98: ROLLBACK
[0m23:58:26.770740 [debug] [Thread-1 (]: On test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98: Close
[0m23:58:26.772739 [info ] [Thread-1 (]: 1 of 2 PASS not_null_freezed_cand1_id .......................................... [[32mPASS[0m in 1.24s]
[0m23:58:26.774779 [debug] [Thread-1 (]: Finished running node test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98
[0m23:58:26.776728 [debug] [Thread-1 (]: Began running node test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4
[0m23:58:26.777723 [info ] [Thread-1 (]: 2 of 2 START test unique_freezed_cand1_id ...................................... [RUN]
[0m23:58:26.780712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98, now test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4)
[0m23:58:26.781708 [debug] [Thread-1 (]: Began compiling node test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4
[0m23:58:26.789831 [debug] [Thread-1 (]: Writing injected SQL for node "test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4"
[0m23:58:26.790831 [debug] [Thread-1 (]: Timing info for test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4 (compile): 23:58:26.782849 => 23:58:26.790831
[0m23:58:26.791824 [debug] [Thread-1 (]: Began executing node test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4
[0m23:58:26.794814 [debug] [Thread-1 (]: Writing runtime sql for node "test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4"
[0m23:58:26.795810 [debug] [Thread-1 (]: Using postgres connection "test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4"
[0m23:58:26.796806 [debug] [Thread-1 (]: On test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4: BEGIN
[0m23:58:26.796806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:58:27.777730 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m23:58:27.779736 [debug] [Thread-1 (]: Using postgres connection "test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4"
[0m23:58:27.781729 [debug] [Thread-1 (]: On test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "marketing"."public"."freezed_cand1"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:58:27.905189 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:58:27.909228 [debug] [Thread-1 (]: Timing info for test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4 (execute): 23:58:26.791824 => 23:58:27.909228
[0m23:58:27.910224 [debug] [Thread-1 (]: On test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4: ROLLBACK
[0m23:58:28.032039 [debug] [Thread-1 (]: On test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4: Close
[0m23:58:28.035075 [info ] [Thread-1 (]: 2 of 2 PASS unique_freezed_cand1_id ............................................ [[32mPASS[0m in 1.25s]
[0m23:58:28.037032 [debug] [Thread-1 (]: Finished running node test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4
[0m23:58:28.042017 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:28.043047 [debug] [MainThread]: On master: BEGIN
[0m23:58:28.044049 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:58:29.117264 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m23:58:29.119314 [debug] [MainThread]: On master: COMMIT
[0m23:58:29.120299 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:29.121264 [debug] [MainThread]: On master: COMMIT
[0m23:58:29.240169 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:58:29.240638 [debug] [MainThread]: On master: Close
[0m23:58:29.241641 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:58:29.242637 [debug] [MainThread]: Connection 'list_marketing_public' was properly closed.
[0m23:58:29.242637 [debug] [MainThread]: Connection 'test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4' was properly closed.
[0m23:58:29.243666 [info ] [MainThread]: 
[0m23:58:29.244661 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 6.72 seconds (6.72s).
[0m23:58:29.245774 [debug] [MainThread]: Command end result
[0m23:58:29.252497 [info ] [MainThread]: 
[0m23:58:29.253500 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:58:29.254490 [info ] [MainThread]: 
[0m23:58:29.255488 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:58:29.256483 [debug] [MainThread]: Command `dbt test` succeeded at 23:58:29.256483 after 6.91 seconds
[0m23:58:29.256483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4C7722B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4CA760B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4CA52AEC0>]}
[0m23:58:29.257955 [debug] [MainThread]: Flushing usage events
[0m23:58:43.854961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F216F2B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F2443EB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F2443E860>]}


============================== 23:58:43.858725 | 580d4a5f-bf7a-4d3a-a0b6-465496d129ec ==============================
[0m23:58:43.858725 [info ] [MainThread]: Running with dbt=1.6.0
[0m23:58:43.859726 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\as4ti\\OneDrive\\PowerBI\\Projects\\AgileEnginePBI\\Git_hub\\sakila_dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\as4ti\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:58:43.947482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '580d4a5f-bf7a-4d3a-a0b6-465496d129ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F1D70CBE0>]}
[0m23:58:43.954926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '580d4a5f-bf7a-4d3a-a0b6-465496d129ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F24574CD0>]}
[0m23:58:43.955944 [info ] [MainThread]: Registered adapter: postgres=1.6.0
[0m23:58:43.963864 [debug] [MainThread]: checksum: 08dabea3fc65f9f8dd48613681c2bcd827397a7ba9ce4c6d52980aba1215e8c9, vars: {}, profile: , target: , version: 1.6.0
[0m23:58:44.000789 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:58:44.000789 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:58:44.006295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '580d4a5f-bf7a-4d3a-a0b6-465496d129ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F246E80D0>]}
[0m23:58:44.017257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '580d4a5f-bf7a-4d3a-a0b6-465496d129ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F246BBA30>]}
[0m23:58:44.018253 [info ] [MainThread]: Found 1 model, 2 tests, 0 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m23:58:44.018253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '580d4a5f-bf7a-4d3a-a0b6-465496d129ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F246BBB50>]}
[0m23:58:44.020247 [info ] [MainThread]: 
[0m23:58:44.021245 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:58:44.023237 [debug] [ThreadPool]: Acquiring new postgres connection 'list_marketing_public'
[0m23:58:44.033863 [debug] [ThreadPool]: Using postgres connection "list_marketing_public"
[0m23:58:44.034865 [debug] [ThreadPool]: On list_marketing_public: BEGIN
[0m23:58:44.034865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:58:45.132181 [debug] [ThreadPool]: SQL status: BEGIN in 1.0 seconds
[0m23:58:45.133242 [debug] [ThreadPool]: Using postgres connection "list_marketing_public"
[0m23:58:45.134231 [debug] [ThreadPool]: On list_marketing_public: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "list_marketing_public"} */
select
      'marketing' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'marketing' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'marketing' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m23:58:45.259493 [debug] [ThreadPool]: SQL status: SELECT 78 in 0.0 seconds
[0m23:58:45.262519 [debug] [ThreadPool]: On list_marketing_public: ROLLBACK
[0m23:58:45.384141 [debug] [ThreadPool]: On list_marketing_public: Close
[0m23:58:45.396926 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:45.397923 [debug] [MainThread]: On master: BEGIN
[0m23:58:45.397923 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:58:46.370214 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m23:58:46.371209 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:46.371209 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:58:46.499125 [debug] [MainThread]: SQL status: SELECT 31 in 0.0 seconds
[0m23:58:46.503150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '580d4a5f-bf7a-4d3a-a0b6-465496d129ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F246BAB60>]}
[0m23:58:46.504112 [debug] [MainThread]: On master: ROLLBACK
[0m23:58:46.621933 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:46.622985 [debug] [MainThread]: On master: BEGIN
[0m23:58:46.860980 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m23:58:46.862023 [debug] [MainThread]: On master: COMMIT
[0m23:58:46.863017 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:46.864973 [debug] [MainThread]: On master: COMMIT
[0m23:58:46.984070 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:58:46.985060 [debug] [MainThread]: On master: Close
[0m23:58:46.986088 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:58:46.987052 [info ] [MainThread]: 
[0m23:58:46.990340 [debug] [Thread-1 (]: Began running node test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98
[0m23:58:46.991337 [info ] [Thread-1 (]: 1 of 2 START test not_null_freezed_cand1_id .................................... [RUN]
[0m23:58:46.992334 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98'
[0m23:58:46.993331 [debug] [Thread-1 (]: Began compiling node test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98
[0m23:58:47.009659 [debug] [Thread-1 (]: Writing injected SQL for node "test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98"
[0m23:58:47.010657 [debug] [Thread-1 (]: Timing info for test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98 (compile): 23:58:46.993331 => 23:58:47.010657
[0m23:58:47.011653 [debug] [Thread-1 (]: Began executing node test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98
[0m23:58:47.025060 [debug] [Thread-1 (]: Writing runtime sql for node "test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98"
[0m23:58:47.026058 [debug] [Thread-1 (]: Using postgres connection "test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98"
[0m23:58:47.026058 [debug] [Thread-1 (]: On test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98: BEGIN
[0m23:58:47.027101 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:58:47.990434 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m23:58:47.992477 [debug] [Thread-1 (]: Using postgres connection "test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98"
[0m23:58:47.993472 [debug] [Thread-1 (]: On test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "marketing"."public"."freezed_cand1"
where id is null



      
    ) dbt_internal_test
[0m23:58:48.123921 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:58:48.127346 [debug] [Thread-1 (]: Timing info for test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98 (execute): 23:58:47.011653 => 23:58:48.127346
[0m23:58:48.128348 [debug] [Thread-1 (]: On test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98: ROLLBACK
[0m23:58:48.245822 [debug] [Thread-1 (]: On test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98: Close
[0m23:58:48.246816 [info ] [Thread-1 (]: 1 of 2 PASS not_null_freezed_cand1_id .......................................... [[32mPASS[0m in 1.25s]
[0m23:58:48.248810 [debug] [Thread-1 (]: Finished running node test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98
[0m23:58:48.248810 [debug] [Thread-1 (]: Began running node test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4
[0m23:58:48.249806 [info ] [Thread-1 (]: 2 of 2 START test unique_freezed_cand1_id ...................................... [RUN]
[0m23:58:48.251801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sakila_dbt.not_null_freezed_cand1_id.28d47efb98, now test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4)
[0m23:58:48.251801 [debug] [Thread-1 (]: Began compiling node test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4
[0m23:58:48.259079 [debug] [Thread-1 (]: Writing injected SQL for node "test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4"
[0m23:58:48.261071 [debug] [Thread-1 (]: Timing info for test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4 (compile): 23:58:48.251801 => 23:58:48.260073
[0m23:58:48.262073 [debug] [Thread-1 (]: Began executing node test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4
[0m23:58:48.264231 [debug] [Thread-1 (]: Writing runtime sql for node "test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4"
[0m23:58:48.265227 [debug] [Thread-1 (]: Using postgres connection "test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4"
[0m23:58:48.266261 [debug] [Thread-1 (]: On test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4: BEGIN
[0m23:58:48.266261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:58:49.223253 [debug] [Thread-1 (]: SQL status: BEGIN in 1.0 seconds
[0m23:58:49.224285 [debug] [Thread-1 (]: Using postgres connection "test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4"
[0m23:58:49.225293 [debug] [Thread-1 (]: On test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4: /* {"app": "dbt", "dbt_version": "1.6.0", "profile_name": "sakila_conn", "target_name": "dev", "node_id": "test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "marketing"."public"."freezed_cand1"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:58:49.347111 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m23:58:49.352158 [debug] [Thread-1 (]: Timing info for test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4 (execute): 23:58:48.262073 => 23:58:49.351148
[0m23:58:49.353160 [debug] [Thread-1 (]: On test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4: ROLLBACK
[0m23:58:49.471468 [debug] [Thread-1 (]: On test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4: Close
[0m23:58:49.472534 [info ] [Thread-1 (]: 2 of 2 PASS unique_freezed_cand1_id ............................................ [[32mPASS[0m in 1.22s]
[0m23:58:49.473497 [debug] [Thread-1 (]: Finished running node test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4
[0m23:58:49.475502 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:49.476525 [debug] [MainThread]: On master: BEGIN
[0m23:58:49.476525 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:58:50.541617 [debug] [MainThread]: SQL status: BEGIN in 1.0 seconds
[0m23:58:50.542669 [debug] [MainThread]: On master: COMMIT
[0m23:58:50.544620 [debug] [MainThread]: Using postgres connection "master"
[0m23:58:50.545611 [debug] [MainThread]: On master: COMMIT
[0m23:58:50.663516 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m23:58:50.664520 [debug] [MainThread]: On master: Close
[0m23:58:50.665592 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:58:50.666096 [debug] [MainThread]: Connection 'list_marketing_public' was properly closed.
[0m23:58:50.666096 [debug] [MainThread]: Connection 'test.sakila_dbt.unique_freezed_cand1_id.95c0e644c4' was properly closed.
[0m23:58:50.666096 [info ] [MainThread]: 
[0m23:58:50.667152 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 6.64 seconds (6.64s).
[0m23:58:50.669089 [debug] [MainThread]: Command end result
[0m23:58:50.675536 [info ] [MainThread]: 
[0m23:58:50.676532 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:58:50.676532 [info ] [MainThread]: 
[0m23:58:50.677544 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:58:50.678526 [debug] [MainThread]: Command `dbt test` succeeded at 23:58:50.678526 after 6.83 seconds
[0m23:58:50.678526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F216F2B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F2472C8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F244FAE90>]}
[0m23:58:50.679524 [debug] [MainThread]: Flushing usage events
